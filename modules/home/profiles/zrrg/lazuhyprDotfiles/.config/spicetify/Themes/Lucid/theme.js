(async () => { while (!Spicetify.React || !Spicetify.ReactDOM) { await new Promise((resolve) => setTimeout(resolve, 10));}"use strict";var Lucid=(()=>{function s(e,o){let t=document.createElement(e);if(!o)return t;if(o.attributes)for(let[a,c]of Object.entries(o.attributes))c?t.setAttribute(a,c):t.removeAttribute(a);o.style&&Object.assign(t.style,o.style);let{style:r,attributes:n,...i}=o;return Object.assign(t,i),t}var X="https://raw.githubusercontent.com/sanoojes/Spicetify-Lucid/refs/heads/main",J="https://cdn.jsdelivr.net/gh/sanoojes/Spicetify-Lucid@main",Q="2.1.3",H="lucid-guided-tour",Qe=[`${X}/src/workers/getColor.js`,`${J}/src/workers/getColor.js`],ge="LUCID_COLOR_SCRIPT_CACHE",je="#1bc858",et="LUCID_GUIDE_SCRIPT_CACHE",$r=[`${X}/src/guidedTour.js`,`${J}/src/guidedTour.js`],tt="lucid-theme-settings",U="lucid-current-version",ot=[`${X}/changelog.json`,`${J}/changelog.json`],he="lucid-changelog-data";var rt=[`${X}/src/icons.css`,`${J}/src/icons.css`,`${X}/styles/icons.css`,`${J}/styles/icons.css`];var nt=".Root__main-view [data-overlayscrollbars-viewport], .Root__main-view .os-viewport, .Root__main-view .main-view-container > .main-view-container__scroll-node:not([data-overlayscrollbars-initialize]), .Root__main-view .main-view-container__scroll-node > [data-overlayscrollbars-viewport], .main-view-container__scroll-node div:nth-child(2)",Be=".under-main-view",it=".main-entityHeader-gradient, .XUwMufC5NCgIyRMyGXLD",Me='url("https://cdn.jsdelivr.net/gh/sanoojes/Spicetify-Lucid@main/assets/placeholder.png")',Pe={showChangelog:!0,position:"nav",background:{mode:"static",options:{static:{isCustomImage:!1,filter:{blur:32,brightness:60,saturate:150}},solid:{color:{hex:"#1a211c",alpha:100}},animated:{time:120,filter:{blur:32,brightness:60,saturate:150}}}},color:{customColor:{hex:"#00ffa1",alpha:100},isTonal:!0,isCustom:!1,isDynamic:!1,extractorOptions:{pixels:36e4,distance:.1,hueDistance:.2,lightnessDistance:.2,saturationDistance:.2}},pages:{homeCardGap:8,panelGap:4,isNewHome:!1,isFlexyHome:!0,hideHomeHeader:!1,style:"card",imageStyle:"default",umv:{type:"normal",isScaling:!0,isScroll:!1,options:{expanded:{filter:{blur:0}},custom:{url:"https://picsum.photos/1920/1080?random",filter:{blur:8}},normal:{filter:{blur:8}},npv:{filter:{blur:8}}}}},border:{thickness:1,color:{hex:"#454545",alpha:50},style:"solid"},control:{height:40},font:{fontFamily:"Outfit",fontUrl:"https://fonts.googleapis.com/css2?family=Outfit:wght@100..900&display=swap",isGoogleFonts:!0},grains:{type:"starry"},rightSidebar:{isCustomBg:!1,mode:"normal",position:"bottom right",blur:16,size:240,color:{hex:"#1a211c",alpha:50}},playbar:{type:"normal",hideIcons:!0,options:{normal:{height:80,paddingX:8,bgColor:{hex:"",alpha:50},bgOpacity:100,imageRadius:8,borderRadius:8,backdropFilter:{blur:32,saturate:150,brightness:60}},compact:{height:64,paddingX:8,bgColor:{hex:"",alpha:50},bgOpacity:100,imageRadius:8,borderRadius:8,backdropFilter:{blur:32,saturate:150,brightness:60}}},isFloating:!0},customImage:{type:"url",options:{url:{data:"https://picsum.photos/1920/1080?random"},local:null}},topbar:{isCustomColor:!1,backdropFilter:{blur:32,brightness:75,contrast:80,grayscale:25,saturate:200},bgColor:{hex:"#1e201d",alpha:20}}};var g=e=>{let o=document.querySelector(`#style-${e}`);return o||(o=s("style",{id:`style-${e}`}),document.head.appendChild(o)),o};var d=(e,o=!1,t)=>{for(;!Spicetify.showNotification;)setTimeout(d,500);console.debug(`Notification: ${e} (Error: ${o}, Timeout: ${t})`),Spicetify.showNotification(e,o,t)};function yo(){for(let e of rt)if(!document.querySelector(`link[href="${e}"]`)){let t=s("link",{rel:"stylesheet",href:e});document.head.appendChild(t)}}var at=()=>{try{yo();let e=(r,n=!1)=>n?o.get(r).replace(/[{0}{1}«»”“]/g,"").trim():o.get(r),o=Spicetify.Locale;if(!o)return;let t={home:e("view.web-player-home"),browse:e("browse"),pause:e("pause"),play:e("play"),close:e("close"),openMiniPlayer:e("miniplayer.open"),createPlaylist:e("contextmenu.create-playlist"),createButton:e("web-player.your-library-x.create.button-label"),fullscreen:e("npv.full-screen"),closeBtn:e("close_button_action"),duration:e("sort.duration"),search:e("navbar.search"),queue:e("playback-control.queue"),searchPlaylist:e("playlist.search_in_playlist"),download:e("download.download"),copyTrackLink:e("context-menu.copy-track-link"),moreContext:e("more.label.context",!0),downloadContext:e("contextmenu.download"),friendActivity:e("buddy-feed.friend-activity"),whatsNew:e("web-player.whats-new-feed.button-label"),skipForward:e("playback-control.skip-forward"),skipBack:e("playback-control.skip-back"),disableShuffle:e("playback-control.disable-shuffle"),enableShuffle:e("playback-control.enable-shuffle"),disableShuffleGeneric:e("web-player.smart-shuffle.button-disable-shuffle-generic"),disableShuffleSpecific:e("web-player.smart-shuffle.button-disable-shuffle-specific",!0),enableShuffleGeneric:e("web-player.smart-shuffle.button-enable-shuffle-generic"),enableShuffleSpecific:e("web-player.smart-shuffle.button-enable-shuffle-specific",!0),enableSmartShuffleSpecific:e("web-player.smart-shuffle.button-enable-smart-shuffle-specific",!0),enableSmartShuffleGeneric:e("web-player.smart-shuffle.button-enable-smart-shuffle-generic"),enableRepeat:e("playback-control.enable-repeat"),enableRepeatOne:e("playback-control.enable-repeat-one"),disableRepeat:e("playback-control.disable-repeat")};g("lucid-icon-patch").innerHTML=`
 .main-yourLibraryX-navLink[aria-label="${t.home}"] path,
 button[aria-label="${t.home}"] path {
 	d: var(--home-icon-24);
 }
 .main-yourLibraryX-navLink[aria-label="${t.home}"].active path,
 .main-globalNav-navLinkActive[aria-label="${t.home}"] path {
 	d: var(--home-filled-icon-24);
 }
 .main-topBar-buddyFeed[aria-label*="${t.whatsNew}"] svg,
 .main-topBar-buddyFeed[aria-label*="${t.friendActivity}"] svg {
 	transform: scale(1.1);
 }
 
 .main-topBar-buddyFeed[aria-label*="${t.friendActivity}"] svg path {
 	d: var(--people-icon);
 }
 .main-topBar-buddyFeed[aria-label*="${t.friendActivity}"] .Svg-img-icon-small-textBase path {
 	d: var(--people-filled-icon);
 }
 .main-topBar-buddyFeed[aria-label*="${t.whatsNew}"] svg path {
 	d: var(--bell-icon);
 }
 .main-topBar-buddyFeed .Svg-img-icon-small[aria-label*="${t.whatsNew}"] .Svg-img-icon-small-textBase path {
 	d: var(--bell-filled-icon);
 }
 .player-controls__left button[aria-label*="${t.disableShuffle}"] path:nth-of-type(n+2),
 .player-controls__left button[aria-label*="${t.disableShuffleSpecific}"] path:nth-of-type(n+2),
 .player-controls__left button[aria-label*="${t.disableShuffleGeneric}"] path:nth-of-type(n+2),
 .player-controls__left button[aria-label*="${t.enableShuffle}"] path:nth-of-type(n+2),
 .player-controls__left button[aria-label*="${t.enableShuffleSpecific}"] path:nth-of-type(n+2),
 .player-controls__left button[aria-label*="${t.enableShuffleGeneric}"] path:nth-of-type(n+2),
 .player-controls__left button[aria-label*="${t.enableSmartShuffleGeneric}"] path:nth-of-type(n+2),
 .player-controls__left button[aria-label*="${t.enableSmartShuffleSpecific}"] path:nth-of-type(n+2),
 .Root__globalNav button[aria-label="${t.browse}"] path:nth-of-type(n + 2) {
 	display: none;
 }
 .Root__globalNav .main-globalNav-navLink.custom-navlink[aria-label*="Marketplace"] path {
 	d: var(--appstore-icon-24);
 	transform: scale(3) !important;
 }
 .Root__globalNav .main-globalNav-navLinkActive.custom-navlink[aria-label*="Marketplace"] path {
 	d: var(--appstore-filled-icon-24);
 }
 .Root__globalNav .IconContainer-leading:first-child svg path,
 .Root__globalNav .IconContainer-leading:has(button[aria-label*="${t.search}"]) div > svg path {
 	d: var(--search-icon-24);
 }
 .Root__globalNav button[aria-label="${t.browse}"] path {
 	d: var(--compass-icon-24);
 }
 .Root__globalNav button[aria-label="${t.browse}"].j4xi27AJ3oy5qZ8CGhhQ path {
 	d: var(--compass-filled-icon-24);
 }
 .player-controls__buttons .player-controls__left button[data-testid="control-button-skip-back"] path,
 .player-controls__buttons .player-controls__left button[aria-label*="${t.skipBack}"] path {
   fill: var(--clr-on-surface);
   d: var(--prev-icon)}
 
 .player-controls__buttons .player-controls__right button[data-testid="control-button-skip-forward"] path,
 .player-controls__buttons .player-controls__right button[aria-label="${t.skipForward}"] path {
   fill: var(--clr-on-surface);
   d: var(--next-icon)}
 
 .player-controls__left button[aria-label*="${t.disableShuffle}"],
 .player-controls__left button[aria-label*="${t.disableShuffleSpecific}"],
 .player-controls__left button[aria-label*="${t.disableShuffleGeneric}"],
 .player-controls__left button[aria-label*="${t.enableShuffle}"],
 .player-controls__left button[aria-label*="${t.enableShuffleSpecific}"],
 .player-controls__left button[aria-label*="${t.enableShuffleGeneric}"],
 .player-controls__left button[aria-label*="${t.enableSmartShuffleGeneric}"],
 .player-controls__left button[aria-label*="${t.enableSmartShuffleSpecific}"],
 .player-controls__right button[aria-label="${t.enableRepeat}"],
 .player-controls__right button[aria-label="${t.enableRepeatOne}"],
 .player-controls__right button[aria-label="${t.disableRepeat}"] {
 	--encore-graphic-size-decorative-smaller: 22px;
 	--encore-control-size-smaller: 22px}
 
 .player-controls__right button[aria-label="${t.enableRepeat}"] path {
 	d: var(--disable-repeat-icon)}
 .player-controls__right button[aria-label="${t.enableRepeatOne}"] path {
   d: var(--repeat-icon)}
 
 .player-controls__right button[aria-label="${t.disableRepeat}"] path {
   d: var(--repeat-one-icon)}
 
 .player-controls__left button[aria-label*="${t.enableShuffle}"] path,
 .player-controls__left button[aria-label*="${t.enableShuffleSpecific}"] path,
 .player-controls__left button[aria-label*="${t.enableShuffleGeneric}"] path {
 	d: var(--disable-shuffle-icon)}
 
 .player-controls__left button[aria-label*="${t.disableShuffleSpecific}"] path,
 .player-controls__left button[aria-label*="${t.disableShuffle}"] path,
 .player-controls__left button[aria-label*="${t.enableSmartShuffleGeneric}"] path,
 .player-controls__left button[aria-label*="${t.enableSmartShuffleSpecific}"] path {
 	d: var(--shuffle-icon)}
 
 .player-controls__left button[aria-label*="${t.disableShuffleSpecific}"] path,
 .player-controls__left button[aria-label*="${t.disableShuffleGeneric}"] path {
 	d: var(--smart-shuffle-icon)}
 
 .main-actionBar-ActionBarRow button[aria-label*="${t.enableShuffle}"] path,
 .main-actionBar-ActionBarRow button[aria-label*="${t.enableShuffleSpecific}"] path,
 .main-actionBar-ActionBarRow button[aria-label*="${t.enableShuffleGeneric}"] path {
   d: var(--disable-shuffle-icon-24, var(--disable-shuffle-icon))}
 
 .main-actionBar-ActionBarRow button[aria-label*="${t.disableShuffleSpecific}"] path,
 .main-actionBar-ActionBarRow button[aria-label*="${t.disableShuffle}"] path,
 .main-actionBar-ActionBarRow button[aria-label*="${t.enableSmartShuffleGeneric}"] path,
 .main-actionBar-ActionBarRow button[aria-label*="${t.enableSmartShuffleSpecific}"] path {
   d: var(--shuffle-icon-24, var(--shuffle-icon))}
 
 .main-actionBar-ActionBarRow button[aria-label*="${t.disableShuffleSpecific}"] path,
 .main-actionBar-ActionBarRow button[aria-label*="${t.disableShuffleGeneric}"] path {
   d: var(--smart-shuffle-icon-24, var(--smart-shuffle-icon))}
 
 .ix_8kg3iUb9VS5SmTnBY button[aria-label*="${t.play}"] svg[viewBox="0 0 24 24"] path {
   d: var(--play-icon-24, var(--play-icon))}
 
 .ix_8kg3iUb9VS5SmTnBY button[aria-label*="${t.pause}"] svg[viewBox="0 0 24 24"] path {
   d: var(--pause-icon-24, var(--pause-icon))}
 
 .ix_8kg3iUb9VS5SmTnBY button[aria-label*="${t.play}"] svg[viewBox="0 0 16 16"] path {
   d: var(--play-icon)}
 
 .ix_8kg3iUb9VS5SmTnBY button[aria-label*="${t.pause}"] svg[viewBox="0 0 16 16"] path {
   d: var(--pause-icon)}
 
 .player-controls__buttons .player-controls__right button[data-testid="control-button-skip-forward"],
 .player-controls__buttons .player-controls__right button[aria-label="${t.skipForward}"],
 .player-controls__buttons .player-controls__left button[data-testid="control-button-skip-back"],
 .player-controls__buttons .player-controls__left button[aria-label*="${t.skipBack}"] {
 	--encore-graphic-size-decorative-smaller: 22px;
 	--encore-control-size-smaller: 22px;
 	color: var(--subtext-color)}
 
 .player-controls__buttons button[aria-label="${t.play}"] path {
   fill: var(--clr-on-surface);
   d: var(--play-icon)}
 
 
 .player-controls__buttons button[aria-label="${t.pause}"] path {
   fill: var(--clr-on-surface);
   d: var(--pause-icon)}
 
 .player-controls__buttons > button,
 .player-controls__buttons button[data-testid=control-button-playpause] { --encore-graphic-size-decorative-smaller: 1.5rem; --encore-control-size-smaller: 1.5rem; }
 .player-controls__buttons button[data-testid=control-button-playpause],
 .player-controls__buttons button[data-testid=control-button-playpause]:hover,
 .player-controls__buttons button[data-testid=control-button-playpause] span:hover,
 .player-controls__buttons button[data-testid=control-button-playpause] span { background: none !important; color: var(--clr-on-surface) }
 
 .x-downloadButton-DownloadButton button[aria-label="${t.download}"] path,
 .x-downloadButton-DownloadButton button[aria-label="${t.downloadContext}"] path {
   d: var(--download-icon-24)}
   
 svg path[d="M3 8a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm6.5 0a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zM16 8a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z"],
 .Root__right-sidebar button[aria-label*="${t.moreContext}"] path{
   d: var(--more-horizontal-icon)}
 
 .main-actionBar-ActionBar button[aria-label*="${t.moreContext}"] path {
   d: var(--more-horizontal-icon-24)}
 
 x-filterBox-expandButton[aria-label*="${t.search}"] path,
 x-filterBox-expandButton[aria-label*="${t.searchPlaylist}"] path,
 .x-filterBox-searchIcon path {
   d: var(--search-icon)}
 
 button[aria-label="${t.copyTrackLink}"] svg[viewBox="0 0 16 16"] path,
 button[aria-label="${t.copyTrackLink}"] svg[viewBox="0 0 16 16"] path,
 button[aria-label="${t.copyTrackLink}"] svg[viewBox="0 0 16 16"] path{
   d: var(--share-icon)}
 
 button[aria-label="${t.copyTrackLink}"] svg[viewBox="0 0 24 24"] path,
 button[aria-label="${t.copyTrackLink}"] svg[viewBox="0 0 24 24"] path,
 button[aria-label="${t.copyTrackLink}"] svg[viewBox="0 0 24 24"] path{
   d: var(--share-icon-24)}
 
 svg path[d="M15 14.5H5V13h10v1.5zm0-5.75H5v-1.5h10v1.5zM15 3H5V1.5h10V3zM3 3H1V1.5h2V3zm0 11.5H1V13h2v1.5zm0-5.75H1v-1.5h2v1.5z"],
 button[aria-controls="sort-and-view-picker"] path,
 .x-sortBox-sortDropdown path {
   d: var(--text-bullet-list-icon)}
 
 svg path[d="M15.5 13.5H.5V12h15v1.5zm0-4.75H.5v-1.5h15v1.5zm0-4.75H.5V2.5h15V4z"]{
   d: var(--list-icon)}
 
 div[data-testid="PanelHeader_CloseButton"] button path,
 .Root__right-sidebar button[aria-label="${t.closeBtn}"] path,
 .Root__right-sidebar button[aria-label="${t.close}"] path{
   d: var(--dismiss-icon)}
 
 .main-trackList-trackListRowGrid button[aria-label="${t.duration}"] path{
   d: var(--clock-icon)}
 
 button[aria-label="${t.createPlaylist}"] path,
 button[aria-label="${t.createButton}"] path,
 svg path[d="M15.25 8a.75.75 0 0 1-.75.75H8.75v5.75a.75.75 0 0 1-1.5 0V8.75H1.5a.75.75 0 0 1 0-1.5h5.75V1.5a.75.75 0 0 1 1.5 0v5.75h5.75a.75.75 0 0 1 .75.75z"]{
   d: var(--add-icon)}
 
 svg path[d="M6.53 9.47a.75.75 0 0 1 0 1.06l-2.72 2.72h1.018a.75.75 0 0 1 0 1.5H1.25v-3.579a.75.75 0 0 1 1.5 0v1.018l2.72-2.72a.75.75 0 0 1 1.06 0zm2.94-2.94a.75.75 0 0 1 0-1.06l2.72-2.72h-1.018a.75.75 0 1 1 0-1.5h3.578v3.579a.75.75 0 0 1-1.5 0V3.81l-2.72 2.72a.75.75 0 0 1-1.06 0z"],
 button[data-testid="fullscreen-mode-button"] path,
 button[aria-label="${t.fullscreen}"] path{
   d: var(--arrow-maximize-icon);
 }
 
 svg path[d="M15 15H1v-1.5h14V15zm0-4.5H1V9h14v1.5zm-14-7A2.5 2.5 0 0 1 3.5 1h9a2.5 2.5 0 0 1 0 5h-9A2.5 2.5 0 0 1 1 3.5zm2.5-1a1 1 0 0 0 0 2h9a1 1 0 1 0 0-2h-9z"],
 button[data-testid="control-button-queue"] path,
 button[aria-label="${t.queue}"] path{
   /* d: var(--queue-icon); */ /* TODO: add new queue icon */
 }
 
 
 button[aria-label="${t.openMiniPlayer}"] path,
 button[data-testid="pip-toggle-button"] path{
   d: var(--pip-icon);
 }
 `}catch(e){console.error("Error patching icons.",e),d("Error patching icons.",!0,5e3)}};var O={defaultMerge:Symbol("deepmerge-ts: default merge"),skip:Symbol("deepmerge-ts: skip")},Yr={defaultMerge:O.defaultMerge};function vo(e,o){return o}function So(e,o){return e.filter(t=>t!==void 0)}var st;(function(e){e[e.NOT=0]="NOT",e[e.RECORD=1]="RECORD",e[e.ARRAY=2]="ARRAY",e[e.SET=3]="SET",e[e.MAP=4]="MAP",e[e.OTHER=5]="OTHER"})(st||(st={}));function lt(e){return typeof e!="object"||e===null?0:Array.isArray(e)?2:ko(e)?1:e instanceof Set?3:e instanceof Map?4:5}function wo(e){let o=new Set;for(let t of e)for(let r of[...Object.keys(t),...Object.getOwnPropertySymbols(t)])o.add(r);return o}function Co(e,o){return typeof e=="object"&&Object.prototype.propertyIsEnumerable.call(e,o)}function pt(e){let o=0,t=e[0]?.[Symbol.iterator]();return{[Symbol.iterator](){return{next(){do{if(t===void 0)return{done:!0,value:void 0};let r=t.next();if(r.done===!0){o+=1,t=e[o]?.[Symbol.iterator]();continue}return{done:!1,value:r.value}}while(!0)}}}}}var ct=["[object Object]","[object Module]"];function ko(e){if(!ct.includes(Object.prototype.toString.call(e)))return!1;let{constructor:o}=e;if(o===void 0)return!0;let t=o.prototype;return!(t===null||typeof t!="object"||!ct.includes(Object.prototype.toString.call(t))||!t.hasOwnProperty("isPrototypeOf"))}function Eo(e,o,t){let r={};for(let n of wo(e)){let i=[];for(let p of e)Co(p,n)&&i.push(p[n]);if(i.length===0)continue;let a=o.metaDataUpdater(t,{key:n,parents:e}),c=dt(i,o,a);c!==O.skip&&(n==="__proto__"?Object.defineProperty(r,n,{value:c,configurable:!0,enumerable:!0,writable:!0}):r[n]=c)}return r}function _o(e){return e.flat()}function xo(e){return new Set(pt(e))}function To(e){return new Map(pt(e))}function Io(e){return e.at(-1)}var be={mergeRecords:Eo,mergeArrays:_o,mergeSets:xo,mergeMaps:To,mergeOthers:Io};function fe(...e){return Lo({})(...e)}function Lo(e,o){let t=Bo(e,r);function r(...n){return dt(n,t,o)}return r}function Bo(e,o){return{defaultMergeFunctions:be,mergeFunctions:{...be,...Object.fromEntries(Object.entries(e).filter(([t,r])=>Object.hasOwn(be,t)).map(([t,r])=>r===!1?[t,be.mergeOthers]:[t,r]))},metaDataUpdater:e.metaDataUpdater??vo,deepmerge:o,useImplicitDefaultMerging:e.enableImplicitDefaultMerging??!1,filterValues:e.filterValues===!1?void 0:e.filterValues??So,actions:O}}function dt(e,o,t){let r=o.filterValues?.(e,t)??e;if(r.length===0)return;if(r.length===1)return Re(r,o,t);let n=lt(r[0]);if(n!==0&&n!==5){for(let i=1;i<r.length;i++)if(lt(r[i])!==n)return Re(r,o,t)}switch(n){case 1:return Mo(r,o,t);case 2:return Po(r,o,t);case 3:return Ro(r,o,t);case 4:return Ho(r,o,t);default:return Re(r,o,t)}}function Mo(e,o,t){let r=o.mergeFunctions.mergeRecords(e,o,t);return r===O.defaultMerge||o.useImplicitDefaultMerging&&r===void 0&&o.mergeFunctions.mergeRecords!==o.defaultMergeFunctions.mergeRecords?o.defaultMergeFunctions.mergeRecords(e,o,t):r}function Po(e,o,t){let r=o.mergeFunctions.mergeArrays(e,o,t);return r===O.defaultMerge||o.useImplicitDefaultMerging&&r===void 0&&o.mergeFunctions.mergeArrays!==o.defaultMergeFunctions.mergeArrays?o.defaultMergeFunctions.mergeArrays(e):r}function Ro(e,o,t){let r=o.mergeFunctions.mergeSets(e,o,t);return r===O.defaultMerge||o.useImplicitDefaultMerging&&r===void 0&&o.mergeFunctions.mergeSets!==o.defaultMergeFunctions.mergeSets?o.defaultMergeFunctions.mergeSets(e):r}function Ho(e,o,t){let r=o.mergeFunctions.mergeMaps(e,o,t);return r===O.defaultMerge||o.useImplicitDefaultMerging&&r===void 0&&o.mergeFunctions.mergeMaps!==o.defaultMergeFunctions.mergeMaps?o.defaultMergeFunctions.mergeMaps(e):r}function Re(e,o,t){let r=o.mergeFunctions.mergeOthers(e,o,t);return r===O.defaultMerge||o.useImplicitDefaultMerging&&r===void 0&&o.mergeFunctions.mergeOthers!==o.defaultMergeFunctions.mergeOthers?o.defaultMergeFunctions.mergeOthers(e):r}function ut(e,o){if(!o)return e;let t=o.split(/[.\[\]'"]/).filter(Boolean),r=e;for(let n of t)if(r&&typeof r=="object"&&n in r)r=r[n];else return;return r}function Oo(e,o){if(e===o)return!0;if(typeof e!="object"||e===null||typeof o!="object"||o===null)return!1;let t=Object.keys(e),r=Object.keys(o);if(t.length!==r.length)return!1;for(let n of t)if(!Object.prototype.hasOwnProperty.call(o,n)||e[n]!==o[n])return!1;return!0}var He=class{constructor(o,t={}){this.subscribers=[];if(this.options={persist:!1,localStorageKey:"storeState",...t},this.options.persist&&this.options.localStorageKey){let r=localStorage.getItem(this.options.localStorageKey);if(!r){this.state=o;return}try{let n=JSON.parse(r);this.state=fe(o,n)}catch(n){console.error("Error parsing stored state from localStorage:",n),this.state=o}}else this.state=o}getState(){return this.state}setState(o,t){let r={...this.state},n=o(this.state,t);this.updateStateAndNotify(n,r)}updateStateAndNotify(o,t){o!==this.state&&(this.state=o,this.notifySubscribers(t),this.options.persist&&this.persist())}subscribe(o,t){let r={subscriber:o,path:t};return this.subscribers.push(r),()=>{this.subscribers=this.subscribers.filter(n=>n!==r)}}notifySubscribers(o){for(let t of this.subscribers){let{subscriber:r,path:n}=t,i=ut(o,n),a=ut(this.state,n);if(!Oo(i,a)){let c=performance.now();try{r(this.state)}catch(u){console.error(`Subscriber at path "${n}" threw an error:`,u)}let p=performance.now()-c;p>10&&console.warn(`Slow subscriber at path "${n}" took ${p.toFixed(2)}ms. Subscriber: ${r}`)}}}persist(){try{this.options.localStorageKey?localStorage.setItem(this.options.localStorageKey,JSON.stringify(this.state)):console.warn("localStorageKey is not defined, skipping persistence.")}catch(o){console.error("Error saving state to localStorage:",o)}}},K=He;function m(e){return e!==null&&typeof e=="object"}function ye(e){return m(e)&&(e.blur===void 0||typeof e.blur=="number")&&(e.brightness===void 0||typeof e.brightness=="number")&&(e.contrast===void 0||typeof e.contrast=="number")&&(e.grayscale===void 0||typeof e.grayscale=="string")&&(e.hueRotate===void 0||typeof e.hueRotate=="string")&&(e.invert===void 0||typeof e.invert=="string")&&(e.opacity===void 0||typeof e.opacity=="number")&&(e.saturate===void 0||typeof e.saturate=="number")&&(e.sepia===void 0||typeof e.sepia=="string")}function j(e){return m(e)&&typeof e.hex=="string"&&typeof e.alpha=="number"}function Ao(e){return m(e)&&typeof e.url=="string"}function Fo(e){return m(e)&&Array.isArray(e.selectedIds)&&e.selectedIds.every(o=>typeof o=="number")&&m(e.slideshow)&&typeof e.slideshow.isSlideshow=="boolean"&&typeof e.slideshow.timeDelay=="number"}function $o(e){return!m(e)||typeof e.isCustom!="boolean"||e.type!=="url"&&e.type!=="local"||!m(e.options)?!1:e.type==="url"?Ao(e.options.url):e.type==="local"?Fo(e.options.local):!1}function No(e){return m(e)&&$o(e.customImage)&&(e.filter===void 0||ye(e.filter))}function Vo(e){return m(e)&&j(e.color)}function Do(e){return m(e)&&ye(e.filter)}function Uo(e){return m(e)&&No(e.static)&&Vo(e.solid)&&Do(e.animated)}function Go(e){return m(e)&&typeof e.mode=="string"&&(e.mode==="static"||e.mode==="solid"||e.mode==="animated")&&Uo(e.options)}function zo(e){return m(e)&&typeof e.thickness=="number"&&j(e.color)&&typeof e.style=="string"}function Wo(e){return m(e)&&(e.mode==="compact"||e.mode==="normal")&&(e.position==="bottom left"||e.position==="bottom right"||e.position==="top left"||e.position==="top right")&&typeof e.blur=="number"&&typeof e.size=="number"&&typeof e.isCustomBg=="boolean"&&j(e.color)}function Ko(e){return m(e)?["normal","expanded","npv"].every(t=>{let r=e[t];return m(r)&&typeof r.isScaling=="boolean"&&typeof r.isScroll=="boolean"&&(r.filter===null||ye(r.filter))}):!1}function qo(e){return m(e)&&(e.type==="npv"||e.type==="normal")&&Ko(e.options)}function Yo(e){return m(e)&&typeof e.panelGap=="number"&&typeof e.hideHomeHeader=="boolean"&&typeof e.style=="string"&&qo(e.umv)}function Zo(e){return m(e)&&typeof e.isDynamic=="boolean"&&typeof e.isCustom=="boolean"&&typeof e.isTonal=="boolean"&&j(e.customColor)}function Xo(e){return m(e)&&ye(e.backdropFilter)&&typeof e.height=="number"&&typeof e.paddingX=="number"&&j(e.bgColor)&&typeof e.bgOpacity=="number"&&typeof e.borderRadius=="number"}function Jo(e){return m(e)?["compact","normal"].every(t=>Xo(e[t])):!1}function Qo(e){return m(e)&&(e.type==="compact"||e.type==="normal")&&Jo(e.options)&&typeof e.isFloating=="boolean"&&typeof e.hideIcons=="boolean"}function jo(e){return m(e)&&(e.type==="default"||e.type==="starry"||e.type==="none")}function ve(e){return m(e)&&(e.position==="context-menu"||e.position==="nav")&&Go(e.background)&&zo(e.border)&&Yo(e.pages)&&Zo(e.color)&&m(e.control)&&typeof e.control.height=="number"&&m(e.font)&&typeof e.font.fontFamily=="string"&&(typeof e.font.fontUrl=="string"||e.font.fontUrl===null)&&typeof e.font.isGoogleFonts=="boolean"&&jo(e.grains)&&Qo(e.playbar)&&Wo(e.rightSidebar)}var Oe=class extends K{constructor(o=Pe,t={persist:!0,localStorageKey:tt}){super(o,t)}setChangelog(o){this.setState(t=>({...t,showChangelog:o}))}setPages(o){this.setState(t=>({...t,pages:{...t.pages,...o}}))}setUMV(o){this.setState(t=>({...t,pages:{...t.pages,umv:{...t.pages.umv,...o}}}))}setUMVOption(o,t){this.setState(r=>({...r,pages:{...r.pages,umv:{...r.pages.umv,options:{...r.pages.umv.options,[o]:{...r.pages.umv.options[o],...t}}}}}))}setUMVFilter(o,t){this.setState(r=>({...r,pages:{...r.pages,umv:{...r.pages.umv,options:{...r.pages.umv.options,[o]:{...r.pages.umv.options[o],filter:{...r.pages.umv.options[o].filter,...t}}}}}}))}setCustomImageType(o){this.setState(t=>({...t,customImage:{...t.customImage,type:o}}))}setCustomImageOptions(o,t){this.setState(r=>({...r,customImage:{...r.customImage,options:{...r.customImage.options,[o]:{...r.customImage.options[o],...t}}}}))}setPosition(o){this.setState(t=>({...t,position:o}))}setBackgroundMode(o){this.setState(t=>({...t,background:{...t.background,mode:o}}))}setStaticBackgroundOptions(o){this.setState(t=>({...t,background:{...t.background,options:{...t.background.options,static:{...t.background.options.static,...o}}}}))}setStaticBackgroundFilter(o){this.setState(t=>({...t,background:{...t.background,options:{...t.background.options,static:{...t.background.options.static,filter:{...t.background.options.static.filter,...o}}}}}))}setAnimatedBackgroundFilter(o){this.setState(t=>({...t,background:{...t.background,options:{...t.background.options,animated:{...t.background.options.animated,filter:{...t.background.options.animated.filter,...o}}}}}))}setStaticBgFilter(o){this.setState(t=>({...t,background:{...t.background,options:{...t.background.options,static:{...t.background.options.static,filter:{...t.background.options.static.filter,...o}}}}}))}setSolidBackgroundColor(o){this.setState(t=>({...t,background:{...t.background,options:{...t.background.options,solid:{...t.background.options.solid,color:{...t.background.options.solid.color,...o}}}}}))}setAnimatedBackgroundOptions(o){this.setState(t=>({...t,background:{...t.background,options:{...t.background.options,animated:{...t.background.options.animated,...o}}}}))}setBorder(o){this.setState(t=>({...t,border:{...t.border,...o}}))}setBorderColor(o){this.setState(t=>({...t,border:{...t.border,color:{...t.border.color,...o}}}))}setControlHeight(o){this.setState(t=>({...t,control:{...t.control,height:o}}))}setFont(o){this.setState(t=>({...t,font:{...t.font,...o}}))}setGrains(o){this.setState(t=>({...t,grains:{...t.grains,...o}}))}setRightSidebar(o){this.setState(t=>({...t,rightSidebar:{...t.rightSidebar,...o}}))}setColor(o){this.setState(t=>({...t,color:{...t.color,...o}}))}setColorExtractorOptions(o){this.setState(t=>({...t,color:{...t.color,extractorOptions:{...t.color.extractorOptions,...o}}}))}setPageStyle(o){this.setState(t=>({...t,pages:{...t.pages,style:o}}))}setPageImageStyle(o){this.setState(t=>({...t,pages:{...t.pages,imageStyle:o}}))}setPlaybar(o){this.setState(t=>({...t,playbar:{...t.playbar,...o}}))}setPlaybarOptions(o,t){this.setState(r=>({...r,playbar:{...r.playbar,options:{...r.playbar.options,[o]:{...r.playbar.options[o],...t}}}}))}setPlaybarFilter(o,t){this.setState(r=>({...r,playbar:{...r.playbar,options:{...r.playbar.options,[o]:{...r.playbar.options[o],backdropFilter:{...r.playbar.options[o].backdropFilter,...t}}}}}))}setTopbarFilter(o){this.setState(t=>({...t,topbar:{...t.topbar,backdropFilter:{...t.topbar.backdropFilter,...o}}}))}setTopbarColor(o){this.setState(t=>({...t,topbar:{...t.topbar,bgColor:{...t.topbar.bgColor,...o}}}))}setIsCustomTopbarColor(o){this.setState(t=>({...t,topbar:{...t.topbar,isCustomColor:o}}))}setRightSidebarColor(o){this.setState(t=>({...t,rightSidebar:{...t.rightSidebar,color:{...t.rightSidebar.color,...o}}}))}setGrainsType(o){this.setState(t=>({...t,grains:{...t.grains,type:o}}))}setDynamicColor(o){this.setState(t=>({...t,color:{...t.color,isDynamic:o}}))}setIsCustomColor(o){this.setState(t=>({...t,color:{...t.color,isCustom:o}}))}setCustomColor(o){this.setState(t=>({...t,color:{...t.color,customColor:{...t.color.customColor,...o}}}))}setTonalColor(o){this.setState(t=>({...t,color:{...t.color,isTonal:o}}))}resetState(){try{this.setState(()=>Pe),localStorage.removeItem(H),localStorage.removeItem(et),localStorage.removeItem(ge),localStorage.removeItem(he),localStorage.removeItem(U),window.location.reload()}catch(o){d("Error reseting settings.",!0,5e3),console.error("Error reseting settings.",o)}}exportSettings(){let o=Ae.getState();return JSON.stringify(o,null,0)}importSettings(o){try{let t=JSON.parse(o);ve(t)?(Ae.setState(r=>fe(r,t)),d("Settings imported successfully!",!1,5e3)):(console.error("Invalid settings format."),d("Import failed: Invalid settings format.",!0,5e3))}catch(t){console.error("Error importing settings:",t),d("Import failed: Unable to parse settings JSON.",!0,5e3)}}},Ae=new Oe,l=Ae;function mt(e){try{let t=new URL(e).searchParams.get("family");return t?t.split(":")[0].split(";")[0].replace(/\+/g," "):null}catch(o){return console.error("Error parsing Google Fonts URL:",o),null}}function ht(){gt(),l.subscribe(e=>{gt(e.font)})}function gt(e=l.getState().font){let o=g("lucid-font"),t=document.head.querySelector("#lucid-custom-font");if(e.isGoogleFonts&&e.fontUrl){t?t.href!==e.fontUrl&&(t.href=e.fontUrl):(t=s("link",{id:"lucid-custom-font",rel:"preload",href:e.fontUrl,as:"style",crossOrigin:"anonymous"}),document.head.appendChild(t));let n=document.head.querySelector("#lucid-custom-font-style");n?n.href!==e.fontUrl&&(n.href=e.fontUrl):(n=s("link",{id:"lucid-custom-font-style",rel:"stylesheet",href:e.fontUrl,crossOrigin:"anonymous"}),document.head.appendChild(n))}else{t&&t.remove();let n=document.head.querySelector("#lucid-custom-font-style");n&&n.remove()}let r=e.isGoogleFonts&&e.fontUrl?mt(e.fontUrl):e.fontFamily;o.innerText=`:root,* { --custom-font: "${r}"; font-family: var(--custom-font) !important; }`}var Se=null,we=null;function Fe(e=l.getState().pages){let o=`playlist-${e.style}`;Se!==o&&(Se?document.body.classList.replace(Se,o):document.body.classList.add(o),Se=o);let t=`playlist-image-${e.imageStyle}`;we!==t&&(we?document.body.classList.replace(we,t):document.body.classList.add(t),we=t),e.hideHomeHeader?document.body.classList.remove("hide-home-header"):document.body.classList.add("hide-home-header"),document.body.style.setProperty("--custom-panel-gap",`${e.panelGap}px`),document.body.style.setProperty("--home-card-gap",`${e.homeCardGap}px`),document.body.classList.toggle("new-home",e.isNewHome),document.body.classList.toggle("flexy-home",e.isNewHome&&e.isFlexyHome)}l.subscribe(e=>{Fe(e.pages)},"pages");var bt=()=>document.querySelector(".Root__right-sidebar .main-nowPlayingView-nowPlayingWidget .main-image-image")?.src||"",ft=async()=>{for(;!Spicetify.Player?.data;)await new Promise(r=>setTimeout(r,50));let e=Spicetify.Player.data?.item;return!e||!e.metadata?(console.error("No item or metadata found in Spicetify Player data."),""):[e.metadata.image_xlarge_url,e.metadata.image_large_url,e.metadata.image_url,e.metadata.image_small_url].find(r=>r)||bt()||bt()},yt=async(e,o,t=3)=>{for(let r=0;r<=t;r++)try{return await Spicetify.GraphQL.Request({...e,operation:"query",value:null},o)}catch(n){if(n instanceof Error&&n.message.includes("DUPLICATE_REQUEST_ERROR")&&r<t){console.warn(`Retrying ${e.name}... (${r+1}/${t})`),await new Promise(i=>setTimeout(i,1e3));continue}throw console.error(`Error in ${e.name}:`,n),n}return null},er=e=>yt({name:"getAlbum",sha256Hash:"469874edcad37b7a379d4f22f0083a49ea3d6ae097916120d9bbe3e36ca79e9d"},{uri:e,locale:null,offset:0,limit:50}),tr=e=>yt({name:"queryArtistOverview",sha256Hash:"35648a112beb1794e39ab931365f6ae4a8d45e65396d641eeda94e4003d41497"},{uri:e,includePrerelease:!0,locale:null}),or=e=>{let o=e.match(/\/(playlist|artist|album|user|show|collection)\/([^/]+)/);if(!o)return console.warn("No valid type or ID found in pathname:",e),null;let[,t,r]=o;return`spotify:${t}:${r}`},vt=async e=>{if(e==="/collection/tracks")return"https://misc.scdn.co/liked-songs/liked-songs-300.jpg";let o=or(e);if(!o)return null;let[,t,r]=o.split(":");try{switch(t){case"playlist":case"show":return(await Spicetify.Platform.PlaylistAPI.getMetadata(o)).images[0]?.url||null;case"artist":{let i=(await tr(o))?.data?.artistUnion?.visuals;return i?.headerImage?.sources[0]?.url||i?.avatarImage?.sources[0]?.url||null}case"album":{let i=(await er(o))?.data?.albumUnion?.coverArt?.sources;return i?.[2]?.url||i?.[0]?.url||null}case"user":return(await Spicetify.Platform.RequestBuilder.build().withHost("https://spclient.wg.spotify.com/user-profile-view/v3").withPath(`/profile/${r}`).send())?.body?.image_url||null;default:return null}}catch(n){return console.error(`Error fetching ${t} artwork:`,n),null}};var A=new K({url:null});async function St(){try{let e=await ft();A.setState(()=>({url:e})),document.body.style.setProperty("--npv-img-url",e?`url(${e})`:Me)}catch(e){console.error("Error updating NPV state:",e),A.setState(()=>({url:null})),document.body.style.setProperty("--npv-img-url",Me)}}St();Spicetify.Player.addEventListener("songchange",St);function wt(e){try{let o=new Blob([e],{type:"application/javascript"}),t=URL.createObjectURL(o),r=new Worker(t,{credentials:"omit"});return r.onerror=n=>{console.error("Worker encountered an error:",n.message||n)},r.onmessage=n=>{console.debug("Worker initialized:",n.data)},r}catch(o){return console.error("Error loading worker:",o),null}}async function Ce(e,o,t=864e5){let r=JSON.parse(localStorage.getItem(o)||"null");if(r?.script&&(!navigator.onLine||Date.now()-r.timestamp<t))return r.script;let n=null;for(let i of e)try{let a=await fetch(i);if(a.ok){n=await a.text();break}}catch{}if(!n){if(r?.script)return r.script;throw new Error("Failed to fetch guide script from all sources.")}return localStorage.setItem(o,JSON.stringify({script:n,timestamp:Date.now()})),n}var F=null,Ct=null,rr=g("clr-lucid");function kt(e){F&&F.postMessage({type:"color",options:e})}function Et(e){F&&F.postMessage({type:"image",options:e})}function _t(e){return e.replace("spotify:image:","https://i.scdn.co/image/")}async function $e(e=l.getState().color){if(await nr(),Ct?.(),e.isDynamic){let o=A.getState().url;o&&Et({url:_t(o),isTonal:e.isTonal,isDark:!0,extractorOptions:e?.extractorOptions??{}}),Ct=A.subscribe(t=>{t.url&&Et({url:_t(t.url),isTonal:e.isTonal,isDark:!0,extractorOptions:e?.extractorOptions??{}})});return}if(e.isCustom){kt({hex:e.customColor.hex,isTonal:e.isTonal,isDark:!0});return}kt({hex:je,isTonal:e.isTonal,isDark:!0})}async function nr(){let e=await Ce(Qe,ge);if(F=wt(e),!F){document.body.dataset.colorFromWorker="false",console.error("Failed to initialize worker from both endpoints."),d("Failed to initialize the color worker. If this issue persists, please report it. (Dynamic and custom colors may not function properly.)",!0,5e3);return}document.body.dataset.colorFromWorker="true",F.onmessage=o=>{let{message:t,data:r}=o.data||{};r?(console.debug(t,`
Event Data:`,o.data),rr.textContent=`:root,body{${r.style}}`):console.error(t??"Color not applied")},F.onerror=o=>{console.error("Worker encountered an error:",o.message||o)}}function xt(e,o=.5){let t=document.querySelectorAll(e);if(t)for(let r of t){let i=r.style.backgroundColor.match(/rgb?\((\d+),\s*(\d+),\s*(\d+)\)/);if(i&&i.length===4){let a=i[1],c=i[2],p=i[3],u=`${a},${c},${p}`;r.style.setProperty("--accent-color",`${u}`),r.style.backgroundColor=`rgba(${u},${o})`}}}var ir=e=>Spicetify.URI.isPlaylistV1OrV2(e)?"playlist":Spicetify.URI.isArtist(e)?"artist":Spicetify.URI.isAlbum(e)?"album":Spicetify.URI.isGenre(e)?"genre":Spicetify.URI.isShow(e)?"show":Spicetify.URI.isSearch(e)?"search":Spicetify.URI.isProfile(e)?"profile":Spicetify.URI.isConcert(e)||Spicetify.URI.isArtistConcerts(e)?"concert":"other",Tt;function It(e){document.body.dataset.path=e,document.body.dataset.pageType=ir(e),e==="/search"&&(Tt=setInterval(()=>xt(".Vn9yz8P5MjIvDT8c0U6w"),300),setTimeout(()=>{clearInterval(Tt)},2e3))}function Lt(){It(Spicetify?.Platform?.History?.location?.pathname||"/"),Spicetify?.Platform?.History?.listen(e=>{!e||!e.pathname||It(e.pathname)})}var ke=()=>Spicetify.Platform&&Spicetify.Platform.operatingSystem==="Windows"?!0:Spicetify.Platform?.PlatformData?.os_name?Spicetify.Platform.PlatformData.os_name.toLowerCase().includes("win"):!1;function ar(){let e=Math.round(window.outerHeight/window.innerHeight*100)/100,o=Math.round(window.innerHeight/window.outerHeight*100)/100;return{zoom:e,inverseZoom:o}}var Bt=Spicetify?.Platform?.version>="1.2.46";function sr(e){let{zoom:o,inverseZoom:t}=ar(),r=e===0?1:e||(Bt?32:64),n=g("transparent-controls");if(r===0){n.textContent=`
:root {--zoom: ${o};--inverse-zoom: ${t};}
body::after {content: ""; height: 0; width: 0; position: fixed; top: 0; right: 0;}`;return}let i=Math.round(135*t),a=e/o,c=32/o,p=Bt?(a-Math.min(c,a))/2:0,u=r/o-p*2;n.textContent=`
:root {--zoom: ${o};--inverse-zoom: ${t};}
body:after {content: ""; height: var(--control-height, ${u}px); width: var(--control-width, ${i}px); position: fixed; top: ${p}px; right: 0; -webkit-backdrop-filter: brightness(2.1); backdrop-filter: brightness(2.1); pointer-events: none;}
html[dir="rtl"] body:after{left: 0;right: inherit}
body.hide-transparent-controls:after{display: none; content: none;}`}async function lr(e){await Spicetify?.Platform?.ControlMessageAPI?._updateUiClient?.updateTitlebarHeight({height:e}),await Spicetify?.Platform?.UpdateAPI?._updateUiClient?.updateTitlebarHeight({height:e}),await Spicetify.CosmosAsync.post("sp://messages/v1/container/control",{type:"update_titlebar",height:`${e}px`})}function Ne(e=l.getState().control.height){lr(e).then(()=>sr(e)).catch(o=>console.error("Failed to update titlebar:",o))}function Mt(){let e=setInterval(()=>Ne(),300);setTimeout(()=>{clearInterval(e)},1e4)}var Pt=()=>{ke()&&(Ne(),Mt(),window.addEventListener("resize",Mt),document.addEventListener("fullscreenchange",()=>{document.body.classList.toggle("hide-transparent-controls",document.fullscreenElement!==null)}),l.subscribe(e=>Ne(e.control.height),"control"))};var I=e=>{if(e<0||e>100)throw new Error("Alpha value must be between 0 and 100");let o=e/100,r=Math.round(o*255).toString(16).toUpperCase();return r.length===1&&(r=`0${r}`),r};function L(e,o,t=100){let r=e.map(n=>document.querySelector(n));r.every(n=>n)?o(r):t>0&&setTimeout(L,300,e,o,--t)}function Rt(e=l.getState().playbar){let o=e.options[e.type],t=g("lucid-playbar");t.textContent=`
    :root,
    .Root__now-playing-bar{
        --npb-height: ${o.height??80}px;
        --npb-blur: ${o.backdropFilter.blur??32}px;
        --npb-padding-x: ${o.paddingX??8}px;
        --npb-saturate: ${o.backdropFilter.saturate??150}%;
        --npb-brightness: ${o.backdropFilter.brightness??80}%;
        --npb-border-radius: ${o.borderRadius??8}px;
        --npb-image-radius: ${o.imageRadius??16}px;
        --npb-bg-opacity: ${o.bgOpacity??50}%;
        --npb-bg-color: ${o.bgColor.hex?o.bgColor.hex+I(o.bgColor.alpha):`rgba(var(--clr-surface-1-rgb), ${o.bgColor.alpha}%)`} ;
    }`,e.isFloating?document.body.setAttribute("npb-is-floating","floating"):document.body.removeAttribute("npb-is-floating"),document.body.setAttribute("npb-type",e.type)}var B=document.querySelector(".Root__now-playing-bar");L([".Root__now-playing-bar"],([e])=>{B=e,Ve()});var Ee=l.getState().playbar.hideIcons;function Ve(){if(!B)return;let e=B.offsetWidth;B.style.setProperty("--width",`${e}px`),De(Ee||e<1e3)}function De(e=l.getState().playbar.hideIcons){B&&(e?B.setAttribute("hide-icons","true"):B.removeAttribute("hide-icons"))}function Ht(){window.addEventListener("resize",Ve),Rt(),De(Ee||(B?.clientWidth||0)<900),l.subscribe(e=>{Ee=e.playbar.hideIcons,De(Ee||(B?.clientWidth||0)<900),Rt(e.playbar)},"playbar"),Ve()}var E=new K({isFloating:!1,position:{top:16,left:16}},{persist:!0,localStorageKey:"lucid-modal-position"});var Ot='<svg width="24" height="24" fill="none" viewBox="0 0 24 24"><path d="m4.21 4.387.083-.094a1 1 0 0 1 1.32-.083l.094.083L12 10.585l6.293-6.292a1 1 0 1 1 1.414 1.414L13.415 12l6.292 6.293a1 1 0 0 1 .083 1.32l-.083.094a1 1 0 0 1-1.32.083l-.094-.083L12 13.415l-6.293 6.292a1 1 0 0 1-1.414-1.414L10.585 12 4.293 5.707a1 1 0 0 1-.083-1.32l.083-.094-.083.094Z" fill="currentColor"/></svg>',At='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 30" width="24px" height="24px"><path fill="currentColor" d="M15,3C8.373,3,3,8.373,3,15c0,5.623,3.872,10.328,9.092,11.63C12.036,26.468,12,26.28,12,26.047v-2.051 c-0.487,0-1.303,0-1.508,0c-0.821,0-1.551-0.353-1.905-1.009c-0.393-0.729-0.461-1.844-1.435-2.526 c-0.289-0.227-0.069-0.486,0.264-0.451c0.615,0.174,1.125,0.596,1.605,1.222c0.478,0.627,0.703,0.769,1.596,0.769 c0.433,0,1.081-0.025,1.691-0.121c0.328-0.833,0.895-1.6,1.588-1.962c-3.996-0.411-5.903-2.399-5.903-5.098 c0-1.162,0.495-2.286,1.336-3.233C9.053,10.647,8.706,8.73,9.435,8c1.798,0,2.885,1.166,3.146,1.481C13.477,9.174,14.461,9,15.495,9 c1.036,0,2.024,0.174,2.922,0.483C18.675,9.17,19.763,8,21.565,8c0.732,0.731,0.381,2.656,0.102,3.594 c0.836,0.945,1.328,2.066,1.328,3.226c0,2.697-1.904,4.684-5.894,5.097C18.199,20.49,19,22.1,19,23.313v2.734 c0,0.104-0.023,0.179-0.035,0.268C23.641,24.676,27,20.236,27,15C27,8.373,21.627,3,15,3z"/></svg>',Ft='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 30" width="24px" height="24px"><path fill="currentColor" d="M25.12,6.946c-2.424-1.948-6.257-2.278-6.419-2.292c-0.256-0.022-0.499,0.123-0.604,0.357 c-0.004,0.008-0.218,0.629-0.425,1.228c2.817,0.493,4.731,1.587,4.833,1.647c0.478,0.278,0.638,0.891,0.359,1.368 C22.679,9.572,22.344,9.75,22,9.75c-0.171,0-0.343-0.043-0.501-0.135C21.471,9.598,18.663,8,15.002,8 C11.34,8,8.531,9.599,8.503,9.615C8.026,9.892,7.414,9.729,7.137,9.251C6.86,8.775,7.021,8.164,7.497,7.886 c0.102-0.06,2.023-1.158,4.848-1.65c-0.218-0.606-0.438-1.217-0.442-1.225c-0.105-0.235-0.348-0.383-0.604-0.357 c-0.162,0.013-3.995,0.343-6.451,2.318C3.564,8.158,1,15.092,1,21.087c0,0.106,0.027,0.209,0.08,0.301 c1.771,3.11,6.599,3.924,7.699,3.959c0.007,0,0.013,0,0.019,0.001c0.194,0,0.377-0.093,0.492-0.25l1.19-1.612 c-2.61-0.629-3.99-1.618-4.073-1.679c-0.444-0.327-0.54-0.953-0.213-1.398c0.326-0.443,0.95-0.541,1.394-0.216 C7.625,20.217,10.172,22,15,22c4.847,0,7.387-1.79,7.412-1.808c0.444-0.322,1.07-0.225,1.395,0.221 c0.324,0.444,0.23,1.066-0.212,1.392c-0.083,0.061-1.456,1.048-4.06,1.677l1.175,1.615c0.115,0.158,0.298,0.25,0.492,0.25 c0.007,0,0.013,0,0.019-0.001c1.101-0.035,5.929-0.849,7.699-3.959c0.053-0.092,0.08-0.195,0.08-0.301 C29,15.092,26.436,8.158,25.12,6.946z M11,19c-1.105,0-2-1.119-2-2.5S9.895,14,11,14s2,1.119,2,2.5S12.105,19,11,19z M19,19 c-1.105,0-2-1.119-2-2.5s0.895-2.5,2-2.5s2,1.119,2,2.5S20.105,19,19,19z"/></svg>',_e='<svg width="24" height="24" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m8.5 16.586-3.793-3.793a1 1 0 0 0-1.414 1.414l4.5 4.5a1 1 0 0 0 1.414 0l11-11a1 1 0 0 0-1.414-1.414L8.5 16.586Z" fill="currentColor"/></svg>',$t='<svg width="24" height="24" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 2c5.523 0 10 4.478 10 10s-4.477 10-10 10S2 17.522 2 12 6.477 2 12 2Zm0 1.667c-4.595 0-8.333 3.738-8.333 8.333 0 4.595 3.738 8.333 8.333 8.333 4.595 0 8.333-3.738 8.333-8.333 0-4.595-3.738-8.333-8.333-8.333ZM12 15.5a1 1 0 1 1 0 2 1 1 0 0 1 0-2Zm0-8.75a2.75 2.75 0 0 1 2.75 2.75c0 1.01-.297 1.574-1.051 2.359l-.169.171c-.622.622-.78.886-.78 1.47a.75.75 0 0 1-1.5 0c0-1.01.297-1.574 1.051-2.359l.169-.171c.622-.622.78-.886.78-1.47a1.25 1.25 0 0 0-2.493-.128l-.007.128a.75.75 0 0 1-1.5 0A2.75 2.75 0 0 1 12 6.75Z" fill="currentColor"/></svg>',Nt='<svg width="24" height="24" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M21.03 2.97a3.578 3.578 0 0 0-5.06 0L14 4.94l-.013-.013a1.75 1.75 0 0 0-2.475 0l-.585.586a1.75 1.75 0 0 0 0 2.474l.012.013-6.78 6.78a2.25 2.25 0 0 0-.659 1.591v.688l-1.28 2.347c-.836 1.533.841 3.21 2.374 2.374l2.347-1.28h.688a2.25 2.25 0 0 0 1.59-.659L16 13.061l.012.012a1.75 1.75 0 0 0 2.475 0l.586-.585a1.75 1.75 0 0 0 0-2.475L19.061 10l1.97-1.97a3.578 3.578 0 0 0 0-5.06ZM12 9.06 14.94 12l-6.78 6.78a.75.75 0 0 1-.531.22H6.75a.75.75 0 0 0-.359.092l-2.515 1.372a.234.234 0 0 1-.159.032.264.264 0 0 1-.138-.075.264.264 0 0 1-.075-.138.234.234 0 0 1 .033-.159l1.372-2.515A.75.75 0 0 0 5 17.25v-.879a.75.75 0 0 1 .22-.53L12 9.061Z" fill="currentColor"/></svg>',Ue='<svg width="16" height="16" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12.012 2.25c.734.008 1.465.093 2.182.253a.75.75 0 0 1 .582.649l.17 1.527a1.384 1.384 0 0 0 1.927 1.116l1.401-.615a.75.75 0 0 1 .85.174 9.792 9.792 0 0 1 2.204 3.792.75.75 0 0 1-.271.825l-1.242.916a1.381 1.381 0 0 0 0 2.226l1.243.915a.75.75 0 0 1 .272.826 9.797 9.797 0 0 1-2.204 3.792.75.75 0 0 1-.848.175l-1.407-.617a1.38 1.38 0 0 0-1.926 1.114l-.169 1.526a.75.75 0 0 1-.572.647 9.518 9.518 0 0 1-4.406 0 .75.75 0 0 1-.572-.647l-.168-1.524a1.382 1.382 0 0 0-1.926-1.11l-1.406.616a.75.75 0 0 1-.849-.175 9.798 9.798 0 0 1-2.204-3.796.75.75 0 0 1 .272-.826l1.243-.916a1.38 1.38 0 0 0 0-2.226l-1.243-.914a.75.75 0 0 1-.271-.826 9.793 9.793 0 0 1 2.204-3.792.75.75 0 0 1 .85-.174l1.4.615a1.387 1.387 0 0 0 1.93-1.118l.17-1.526a.75.75 0 0 1 .583-.65c.717-.159 1.45-.243 2.201-.252Zm0 1.5a9.135 9.135 0 0 0-1.354.117l-.109.977A2.886 2.886 0 0 1 6.525 7.17l-.898-.394a8.293 8.293 0 0 0-1.348 2.317l.798.587a2.881 2.881 0 0 1 0 4.643l-.799.588c.32.842.776 1.626 1.348 2.322l.905-.397a2.882 2.882 0 0 1 4.017 2.318l.11.984c.889.15 1.798.15 2.687 0l.11-.984a2.881 2.881 0 0 1 4.018-2.322l.905.396a8.296 8.296 0 0 0 1.347-2.318l-.798-.588a2.881 2.881 0 0 1 0-4.643l.796-.587a8.293 8.293 0 0 0-1.348-2.317l-.896.393a2.884 2.884 0 0 1-4.023-2.324l-.11-.976a8.988 8.988 0 0 0-1.333-.117ZM12 8.25a3.75 3.75 0 1 1 0 7.5 3.75 3.75 0 0 1 0-7.5Zm0 1.5a2.25 2.25 0 1 0 0 4.5 2.25 2.25 0 0 0 0-4.5Z" fill="currentColor"/></svg>';var Vt="https://github.com/sanoojes/Spicetify-Lucid",Dt="https://discord.gg/PWEyKduwJh";var cr=(e="base")=>`encore-internal-color-text-${e}`,y=(e="variable-text",o="base")=>`encore-text ${e==="variable-text"?`encore-${e}`:`encore-text-${e}`} ${cr(o)}`;var S=class extends HTMLElement{constructor(t){super();this.customClass="";this._type="primary";this._isIcon=!1;this._handleClick=()=>{!this.disabled&&this.onChange&&this.onChange()};t&&(this.type=t.type??this.type,this.customClass=t.customClass??this.customClass,this.disabled=t.disabled??this.disabled,this.isIcon=t.isIcon??this._isIcon,this.onChange=t.onChange,t.textContent&&(this.textContent=t.textContent),t.innerHTML&&(this.innerHTML=t.innerHTML),t.ariaLabel&&(this.ariaLabel=t.ariaLabel),t.style&&Object.assign(this.style,t.style)),this.addEventListener("click",this._handleClick)}connectedCallback(){this.classList.add("lucid-button"),this._updateClasses(),this.setAttribute("role","button")}disconnectedCallback(){this.removeEventListener("click",this._handleClick)}_updateClasses(){this.className=`lucid-button ${this.customClass}`,this.classList.toggle("icon",this._isIcon),this.classList.toggle("disabled",this.disabled);for(let t of this.classList)["primary","secondary","tertiary","danger"].includes(t)&&this.classList.remove(t);if(this.classList.add(this.type),this._isIcon&&this.type==="icon"){let t=y("body-small-bold");t&&this.classList.add(t)}}set isIcon(t){this._isIcon=t,t?(this.classList.add("icon"),this.setAttribute("is-icon","true")):(this.classList.remove("icon"),this.removeAttribute("is-icon")),this._updateClasses()}get isIcon(){return this._isIcon}set type(t){this._type=t,this.setAttribute("type",t),this._updateClasses()}get type(){return this._type}set disabled(t){t?(this.setAttribute("disabled","true"),this.setAttribute("aria-disabled","true")):(this.removeAttribute("disabled"),this.removeAttribute("aria-disabled")),this._updateClasses()}get disabled(){return this.hasAttribute("disabled")}};customElements.define("custom-button",S);var M=class e extends HTMLElement{constructor(){super();this._previouslyFocusedElement=null;this._bgElem=s("div",{className:"modal-backdrop"}),this._bgElem.addEventListener("click",()=>this.close()),this._modalElem=s("div",{className:"modal",role:"dialog",ariaModal:"true"}),this._headerWrapperElem=s("div",{className:"modal-header-container"}),this._headerElem=s("h2",{className:`modal-header ${y("title-small")}`,id:"modal-header"});let t=s("div",{className:"modal-header-buttons"});this._closeBtn=this.createIconButton("close","Close Button",Ot,()=>this.close()),this._githubBtn=this.createIconButton("github","Github Button",At,()=>window.open(Vt)),this._discordBtn=this.createIconButton("discord","Discord Button",Ft,()=>window.open(Dt)),t.append(this._discordBtn,this._githubBtn,this._closeBtn),this._headerWrapperElem.append(this._headerElem,t),this._modalElem.appendChild(this._headerWrapperElem),this._bodyElem=s("div",{className:"modal-body"}),this._scrollElem=s("div",{className:"modal-scroll"}),this._bodyElem.appendChild(this._scrollElem),this._modalElem.appendChild(this._bodyElem),this.append(this._bgElem,this._modalElem)}static{this.zIndexCounter=1e3}createIconButton(t,r,n,i){let a=new S;return a.customClass=t,a.ariaLabel=r,a.innerHTML=n.toString(),a.type="icon",a.addEventListener("click",i),a}resetPosition(){this._modalElem.style.transform="translate3d(-50%,-50%,0px)"}get scrollElem(){return this._scrollElem}set isOpen(t){t?this.setAttribute("open","true"):this.removeAttribute("open")}get isOpen(){return!!this.getAttribute("open")}setHeader(t){this._headerElem.innerHTML=t.toString()}open(){this.isOpen=!0,this._previouslyFocusedElement=document.activeElement,this._bgElem.classList.add("modal-backdrop--open"),this._modalElem.classList.add("modal--open"),this._closeBtn.focus(),this.resetPosition(),e.zIndexCounter+=1,this._bgElem.style.zIndex=String(e.zIndexCounter),this._modalElem.style.zIndex=String(e.zIndexCounter),this.dispatchEvent(new Event("open"))}close(){this.isOpen=!1,this._bgElem.classList.remove("modal-backdrop--open"),this._modalElem.classList.remove("modal--open"),this.removeAttribute("open"),this._previouslyFocusedElement&&(this._previouslyFocusedElement.focus(),this._previouslyFocusedElement=null),this.dispatchEvent(new Event("close"))}setContent(t){this._scrollElem.textContent="",typeof t=="string"?this._scrollElem.textContent=t:this._scrollElem.append(t)}};customElements.define("lucid-modal",M);var q=class extends M{constructor(){super();this.dragging=!1;this.startX=0;this.startY=0;this.initialLeft=0;this.initialTop=0;this.setPosition=(t,r)=>{E.setState(n=>({isFloating:n.isFloating,position:{top:t,left:r}}))};this.handlePointerDown=t=>{if(!this.isFloating)return;this.dragging=!0,this.startX=t.clientX,this.startY=t.clientY;let r=this._modalElem.getBoundingClientRect();this.initialLeft=r.left,this.initialTop=r.top,this.setAttribute("dragging","true"),document.addEventListener("pointermove",this.handlePointerMove),document.addEventListener("pointerup",this.handlePointerUp)};this.handlePointerMove=t=>{if(!this.dragging)return;let r=t.clientX-this.startX,n=t.clientY-this.startY,i=this.initialLeft+r,a=this.initialTop+n,c=this._modalElem.getBoundingClientRect(),p=c.width,u=c.height;i=Math.max(0,Math.min(i,window.innerWidth-p-16)),a=Math.max(0,Math.min(a,window.innerHeight-u-16)),this._modalElem.style.transform=`translate3d(${i}px,${a}px,0px)`,this.setPosition(a,i)};this.handlePointerUp=t=>{this.dragging=!1,this.removeAttribute("dragging"),document.removeEventListener("pointermove",this.handlePointerMove),document.removeEventListener("pointerup",this.handlePointerUp)};super.setHeader("Lucid Settings")}makeFloating(){let t=E.getState().position;t&&t.top!==void 0&&t.left!==void 0&&(this._modalElem.style.transform=`translate3d(${t.left}px,${t.top}px,0px)`),this.setAttribute("floating","true"),this._modalElem.classList.add("modal--floating"),this._bgElem.classList.add("modal-backdrop--floating"),this._headerWrapperElem.addEventListener("pointerdown",this.handlePointerDown)}removeFloating(){this.removeAttribute("floating"),this.resetPosition(),this._bgElem.classList.remove("modal-backdrop--floating"),this._modalElem.classList.remove("modal--floating"),this._headerWrapperElem.removeEventListener("pointerdown",this.handlePointerDown)}set isFloating(t){t?(this.setAttribute("is-floating","true"),this.makeFloating()):(this.removeAttribute("is-floating"),this.removeFloating())}get isFloating(){return!!this.getAttribute("is-floating")}open(){if(super.open(),this.isFloating){let t=E.getState().position;t&&t.top!==void 0&&t.left!==void 0&&(this._modalElem.style.transform=`translate3d(${t.left}px,${t.top}px,0px)`)}}};customElements.define("lucid-settings-modal",q);window.Modal=M;window.FloatingModal=q;var $=null;function Ge(e,o){$&&($ instanceof Spicetify.Topbar.Button?$.element?.remove():$.deregister(),$=null),e==="context-menu"?Spicetify?.Menu?.Item?($=new Spicetify.Menu.Item("Lucid Settings",!1,o,Ue),$.register()):console.error("Context menu unavailable.Try Switching to Nav."):e==="nav"&&(Spicetify?.Topbar?.Button?$=new Spicetify.Topbar.Button("Lucid Settings",Ue,o,!1,!0):console.error("Nav bar unavailable.Try Switching to Context Menu."))}var N=null,_=null,pr=100,dr=150,b=s("div",{id:"tooltip",role:"tooltip",ariaHidden:"true",style:{position:"fixed",display:"block",padding:"0.5rem 1rem",border:"1px solid var(--border-color, var(--clr-surface-0))",color:"var(--clr-on-surface, #fafafa)",backgroundColor:"rgba(var(--clr-surface-0-rgb, var(--spice-rgb-main)), 0.85)",borderRadius:"6px",boxShadow:"0 4px 12px rgba(var(--clr-shadow-rgb), 0.25)",backdropFilter:"blur(10px)",transition:"opacity 0.2s ease-out, transform 0.2s ease-out, visibility 0.2s ease-out",pointerEvents:"auto",zIndex:"1000",opacity:"0",visibility:"hidden",transform:"translateY(-5px) scale(0.95)",maxWidth:`${window.innerWidth/2}px`,fontSize:"0.875rem",textAlign:"center"}}),ee=s("span",{className:"tooltip-content",style:{display:"inline-block",transition:"opacity 0.3s ease"}});b.appendChild(ee);document.body.appendChild(b);b.addEventListener("mouseenter",()=>{_&&(clearTimeout(_),_=null)});b.addEventListener("mouseleave",()=>{Ut()});function ur(e,o){o&&(_&&(clearTimeout(_),_=null),N&&(clearTimeout(N),N=null),N=setTimeout(()=>{typeof o=="string"?ee.innerHTML=`<span style="font-weight: 500; color: inherit;">${o}</span>`:(ee.innerHTML="",ee.appendChild(o)),b.style.visibility="visible",b.style.opacity="1",b.style.transform="translateY(0) scale(1)",b.setAttribute("aria-hidden","false");let t,r;if(e.target instanceof HTMLElement){let n=e.target.getBoundingClientRect();t=n.left+n.width/2-b.offsetWidth/2,r=n.top-b.offsetHeight}else t=e.clientX+10,r=e.clientY+10;t=Math.max(0,Math.min(t,window.innerWidth-b.offsetWidth)),b.style.left=`${t}px`,b.style.top=`${r}px`,b.style.maxWidth=`${window.innerWidth/2}px`,N=null},pr))}function Ut(){b.matches(":hover")||ee.matches(":hover")||(N&&(clearTimeout(N),N=null),_&&(clearTimeout(_),_=null),_=setTimeout(()=>{b.style.opacity="0",b.style.transform="translateY(-5px) scale(0.95)",b.style.visibility="hidden",b.setAttribute("aria-hidden","true"),_=null},dr))}var xe=class{constructor(o){this.open=!1;this.content=o,this.elem=s("div",{className:"tooltip-wrapper",innerHTML:`<span class="icon" style="height:24px; width:24px;">${$t}</span>`,style:{cursor:"help",display:"inline-flex"},ariaLabel:typeof o=="string"?o:void 0,ariaHasPopup:"true"}),this.mouseoverHandler=t=>{this.open=!0,ur(t,this.content)},this.mouseoutHandler=()=>{!this.elem.matches(":hover")&&this.open&&(Ut(),this.open=!1)},this.elem.addEventListener("mouseenter",this.mouseoverHandler),this.elem.addEventListener("mouseleave",this.mouseoutHandler)}dispose(){this.elem.removeEventListener("mouseenter",this.mouseoverHandler),this.elem.removeEventListener("mouseleave",this.mouseoutHandler),this.elem.parentNode&&this.elem.parentNode.removeChild(this.elem)}};var te=class extends HTMLElement{constructor(){super();this._options=[];this._value="";this._isOpen=!1;this._highlightedIndex=-1;this.shadow=this.attachShadow({mode:"open"}),this.handleDocumentClick=this.handleDocumentClick.bind(this)}set options(t){this._options=t,this.renderOptions()}get options(){return this._options}set value(t){this._value=t,this.updateSelected()}get value(){return this._value}connectedCallback(){this.render(),document.addEventListener("click",this.handleDocumentClick)}disconnectedCallback(){document.removeEventListener("click",this.handleDocumentClick)}render(){this.shadow.innerHTML=`
        <style>.option,.trigger{cursor:pointer;transition:background 225ms ease-in-out}.select-container{width:100%;min-width:6rem;position:relative}.options,.options::before{width:100%;position:absolute}.trigger{padding:.5rem .75rem;background-color:var(--clr-surface-2);width:100%;display:flex;align-items:center;text-align:left;line-height:1px;justify-content:space-between;color:var(--clr-on-surface);border:var(--border-thickness,1px) var(--border-style,solid) var(--border-color,#45454550);border-radius:.5rem}.options{list-style:none;padding:0;margin:0;border:1px solid #ccc;scrollbar-width:thin;background:rgba(var(--clr-surface-1-rgb),.5);z-index:10;max-height:200px;overflow-y:auto;border:var(--border-thickness,1px) var(--border-style,solid) var(--border-color,#45454550);border-radius:.5rem;-webkit-backdrop-filter:blur(8px) saturate(150%);backdrop-filter:blur(8px) saturate(150%)}.options.hidden{display:none}.option{padding:.5rem}.option:last-child{border-bottom:none}.option.highlighted,.option[aria-selected=true]{background:rgba(var(--clr-surface-2-rgb),.7)}.option:hover,.trigger:hover,.trigger[aria-expanded=true]{background:rgba(var(--clr-surface-3-rgb),.75)}.icon{color:var(--clr-on-surface,var(--spice-text));height:20px;width:20px}.trigger,.option{font-size: .85rem;font-weight:500;font-family:inherit;color: var(--clr-on-surface,var(--spice-text,#fafafa))}</style>
        <div class="select-container">
          <button type="button" class="trigger" aria-haspopup="listbox" aria-expanded="false">
            <span class="selected-value"></span>
            <span class="icon" aria-hidden="true">
              <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                <path d="M5.79681 7C4.95612 7 4.49064 7.97434 5.01887 8.62834L8.83333 13.351C9.43371 14.0943 10.5668 14.0943 11.1672 13.351L14.9816 8.62834C15.5098 7.97434 15.0444 7 14.2037 7H5.79681Z" fill="currentColor"/>
              </svg>
            </span>
          </button>
          <ul class="options hidden" role="listbox" tabindex="-1"></ul>
        </div>
      `,this._trigger=this.shadow.querySelector(".trigger"),this._selectedValueSpan=this.shadow.querySelector(".selected-value"),this._optionsList=this.shadow.querySelector(".options"),this._trigger.addEventListener("click",()=>this.checkboxOptions()),this._trigger.addEventListener("keydown",t=>this.handleTriggerKeydown(t)),this._optionsList.addEventListener("click",t=>this.handleOptionClick(t)),this._optionsList.addEventListener("keydown",t=>this.handleOptionsKeydown(t)),this.renderOptions(),this.updateSelected()}renderOptions(){if(this._optionsList){this._optionsList.innerHTML="";for(let[t,r]of this._options.entries()){let n=s("li",{role:"option",className:"option",textContent:r.label,ariaSelected:r.value===this._value?"true":"false"});n.setAttribute("data-index",t.toString()),n.setAttribute("data-value",r.value),this._optionsList.appendChild(n)}}}updateSelected(){if(!this._selectedValueSpan)return;let t=this._options.find(n=>n.value===this._value);this._selectedValueSpan.textContent=t?t.label:"Select an option";let r=Array.from(this._optionsList.children);for(let n of r){let i=n.getAttribute("data-value");n.setAttribute("aria-selected",i===this._value?"true":"false")}}checkboxOptions(){this._isOpen=!this._isOpen,this._isOpen?this.openOptions():this.closeOptions()}openOptions(){this._optionsList.classList.remove("hidden"),this._trigger.setAttribute("aria-expanded","true"),this._highlightedIndex=this._options.findIndex(t=>t.value===this._value),this._highlightedIndex===-1&&(this._highlightedIndex=0),this.highlightOption(this._highlightedIndex),this._optionsList.focus()}closeOptions(){this._isOpen=!1,this._optionsList.classList.add("hidden"),this._trigger.setAttribute("aria-expanded","false"),this._highlightedIndex=-1}handleTriggerKeydown(t){switch(t.key){case"ArrowDown":t.preventDefault(),this.openOptions();break;case"Enter":case" ":t.preventDefault(),this.checkboxOptions();break}}handleOptionsKeydown(t){switch(t.key){case"ArrowDown":t.preventDefault(),this.moveHighlight(1);break;case"ArrowUp":t.preventDefault(),this.moveHighlight(-1);break;case"Enter":t.preventDefault(),this.selectHighlighted();break;case"Escape":t.preventDefault(),this.closeOptions(),this._trigger.focus();break}}handleOptionClick(t){let r=t.target;if(r&&r.getAttribute("role")==="option"){let n=Number.parseInt(r.getAttribute("data-index")||"0",10);this._highlightedIndex=n,this.selectHighlighted()}}moveHighlight(t){let r=this._options.length;r!==0&&(this._highlightedIndex=(this._highlightedIndex+t+r)%r,this.highlightOption(this._highlightedIndex))}highlightOption(t){let r=this._optionsList.querySelectorAll(".option"),n=0;for(let i of r)n===t?(i.classList.add("highlighted"),i.scrollIntoView({block:"nearest"})):i.classList.remove("highlighted"),n++}selectHighlighted(){if(this._highlightedIndex>=0&&this._highlightedIndex<this._options.length){let t=this._options[this._highlightedIndex];this._value=t.value,this.updateSelected(),this.closeOptions(),this._trigger.focus(),this.dispatchEvent(new Event("change",{bubbles:!0}))}}handleDocumentClick(t){this.contains(t.target)||this.closeOptions()}};customElements.define("accessible-select",te);function Gt(e,o){if(e===o)return!0;let t=Object.keys(e),r=Object.keys(o);if(t.length!==r.length)return!1;for(let n of t)if(e[n]!==o[n])return!1;return!0}var oe=class extends HTMLElement{constructor(){super(...arguments);this._renderedOptions=null;this._inputElement=null;this._previewElement=null}set inputOptions(t){this._inputOptions=t,this.render()}get inputOptions(){return this._inputOptions}connectedCallback(){this.render()}removeContent(){this._inputElement=null,this._previewElement=null,this.innerHTML=""}render(){if(this._renderedOptions&&Gt(this._renderedOptions,this._inputOptions))return;this.removeContent();let t=(r,n,i)=>{let a=this._inputElement,c=a.value,p=i?i(c):c;if(!r){n?.(p);return}let u=r(p);u.isValid?(a.classList.remove("error","shake-error"),n?.(p)):(a.classList.remove("shake-error"),a.offsetWidth,a.classList.add("error","shake-error"),u.message&&d(u.message,!0,2e3))};switch(this._inputOptions.type){case"button":{let{buttonType:r,onClick:n,contents:i}=this._inputOptions;this._inputElement=new S,this._inputElement.type=r||"primary",n&&(this._inputElement.onclick=n),this._inputElement.innerHTML=i?.toString()||"Button",this.append(this._inputElement);break}case"number":{let{type:r,step:n,value:i,onChange:a,validator:c}=this._inputOptions;this._inputElement=s("input",{type:r,step:n?.toString()||"1",value:i?.toString(),className:"input number"});let p=new S;p.innerHTML=_e,p.type="icon",p.onclick=()=>t(c,a,u=>Number.parseFloat(u)),this.append(this._inputElement,p);break}case"text":{let{type:r,value:n,onChange:i,validator:a}=this._inputOptions;this._inputElement=s("input",{type:r,value:n,className:"input text"});let c=new S;c.innerHTML=_e,c.type="icon",c.onclick=()=>t(a,i),this.append(this._inputElement,c);break}case"checkbox":{let{onChange:r,checked:n,type:i}=this._inputOptions;this._inputElement=s("input",{checked:n,type:i,className:"checkbox custom"}),this._inputElement.onchange=a=>r?.(a.target.checked),this.append(this._inputElement);break}case"select":{let{options:r,value:n,onChange:i}=this._inputOptions;this._inputElement=new te,r&&(this._inputElement.options=r),n&&(this._inputElement.value=n),this._inputElement.onchange=a=>i?.(a.target.value),this.append(this._inputElement);break}case"color":{let{value:r,onChange:n}=this._inputOptions;this._inputElement=s("input",{type:"color",value:r,className:"input color"});let i=new S;i.innerHTML=Nt,i.type="icon",i.onclick=async()=>{if(!("EyeDropper"in window)&&window.EyeDropper){d("EyeDropper API is not supported in this browser.",!0,3e3);return}try{if(!window.EyeDropper)return;let u=(await new window.EyeDropper().open()).sRGBHex;this._inputElement.value=u,n?.(u)}catch(c){c instanceof Error&&c.message!=="No color selected"&&(console.error("EyeDropper Error:",c),d("Failed to pick color with EyeDropper.",!0,3e3))}};let a=new S;a.innerHTML=_e,a.type="icon",a.onclick=()=>{t(()=>({isValid:!0}),n)},window.EyeDropper?this.append(this._inputElement,i,a):this.append(this._inputElement,a);break}case"image":{let{onChange:r}=this._inputOptions;this._inputElement=s("input",{type:"file",accept:"image/*",className:"input image",style:{display:"none",visibility:"hidden"}}),this._previewElement=s("img",{className:"image-preview",style:{borderRadius:"0.5rem"}}),this._previewElement.src="",this.prepend(this._previewElement),this._inputElement.onchange=n=>{let a=n.target.files?.[0];if(a){let c=new FileReader;c.onload=p=>{let u=p.target?.result;r?.(u),this._previewElement&&(this._previewElement.src=u)},c.readAsDataURL(a)}else r?.(null),this._previewElement&&(this._previewElement.src="")},this.append(new S({type:"primary",textContent:"Select Image",onChange:()=>{this._inputElement?.click()}}),this._inputElement);break}default:console.error("Unsupported input options:",this._inputOptions)}this._renderedOptions=this._inputOptions}};customElements.define("custom-input",oe);var re=class extends HTMLElement{constructor(){super(...arguments);this._isRender=!1;this.rendered=!1;this._settings=[];this.sectionElements=[]}connectedCallback(){!this.sectionElements.length&&this._settings.length&&this.createSectionElements(),this.render(),this.updateVisibility()}set options(t){this._settings=t,this.updateSectionElements(),this.render(),this.updateVisibility()}set isRender(t){this._isRender=t,this.updateVisibility()}get isRender(){return this._isRender}updateVisibility(){this._isRender?(this.removeAttribute("hidden"),this.style.display="flex",this.style.visibility="visible"):(this.setAttribute("hidden","true"),this.style.display="none",this.style.visibility="hidden")}clear(){this.innerHTML=""}createSectionElements(){this.sectionElements=[];for(let t of this._settings){let r=new ne;r.options=t,this.sectionElements.push(r)}}updateSectionElements(){let t=new Map;for(let n of this.sectionElements){let i=n._name;t.set(i,n)}let r=[];for(let n of this._settings){let i=n.name,a=t.get(i);a||(a=new ne),a.options=n,r.push(a)}this.sectionElements=r}render(){!this._settings||this._settings.length===0||this.rendered||(this.clear(),this.append(...this.sectionElements),this.rendered=!0)}};customElements.define("settings-main",re);var ne=class extends HTMLElement{constructor(){super();this._isRender=!1;this.rendered=!1;this._name="";this._groups=[];this.groupElements=[];this._headerElement=s("div",{className:"header-wrapper",style:{textAlign:"center"}}),this._groupsWrapperElement=s("div",{style:{marginTop:".25rem",display:"flex",flexDirection:"column",gap:".5rem",width:"100%"}})}connectedCallback(){!this.groupElements.length&&this._groups.length&&this.createGroupElements(),this.render(),this.updateVisibility()}set options(t){this._name=t.name,this._groups=t.groups,this._isRender=t.render,this.updateGroupElements(),this.render(),this.updateVisibility()}set isRender(t){this._isRender=t,this.updateVisibility()}get isRender(){return this._isRender}updateVisibility(){this._isRender?(this.removeAttribute("hidden"),this.style.display="block",this.style.visibility="visible"):(this.setAttribute("hidden","true"),this.style.display="none",this.style.visibility="hidden")}clear(){this.innerHTML="",this._headerElement.innerHTML="",this._groupsWrapperElement.innerHTML=""}createGroupElements(){this.groupElements=[];for(let t of this._groups){let r=new ie;r.options=t,this.groupElements.push(r)}}updateGroupElements(){let t=new Map;for(let n of this.groupElements)t.set(n._key,n);let r=[];for(let n of this._groups){let i=t.get(n.key);i||(i=new ie),i.options=n,r.push(i)}this.groupElements=r}render(){!this._groups||this._groups.length===0||this.rendered||(this.dataset.tabId=this._name.toLowerCase(),this.clear(),this._headerElement.append(s("h3",{textContent:this._name,className:y("title-small"),style:{fontSize:"1.25rem"}})),this._groupsWrapperElement.append(...this.groupElements),this.append(this._headerElement,this._groupsWrapperElement),this.rendered=!0)}};customElements.define("setting-section",ne);var ie=class extends HTMLElement{constructor(){super();this._isRender=!1;this.rendered=!1;this._showName=!0;this._name="Section";this._fields=[];this._key="";this.fieldElements=[];this._nameContainerElement=s("div"),this._fieldsContainerElement=s("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"}})}connectedCallback(){!this.fieldElements.length&&this._fields.length&&this.createFieldElements(),this.render(),this.updateVisibility()}set options(t){this._name=t.name,this._fields=t.fields,this._isRender=t.render,this._key=t.key,this._showName=t.showName??!0,this.updateFieldElements(),this.updateVisibility()}set isRender(t){this._isRender=t,this.updateVisibility()}get isRender(){return this._isRender}updateVisibility(){this._isRender?(this.removeAttribute("hidden"),this.style.display="flex",this.style.visibility="visible"):(this.setAttribute("hidden","true"),this.style.display="none",this.style.visibility="hidden")}clear(){this.innerHTML="",this._nameContainerElement.innerHTML="",this._fieldsContainerElement.innerHTML=""}createFieldElements(){this.fieldElements=[];for(let t of this._fields){let r=new ae;r.isRender=t.render??!0,r.inputOptions=t.inputOptions,r.label=t.label,r.fieldKey=t.key,t.tooltip&&(r.tooltip=t.tooltip),this.fieldElements.push(r)}}updateFieldElements(){let t=new Map;for(let n of this.fieldElements)t.set(n.fieldKey,n);let r=[];for(let n of this._fields){let i=t.get(n.key);i?(i.isRender=n.render??!0,i.inputOptions=n.inputOptions,n.tooltip&&(i.tooltip=n.tooltip)):(i=new ae,i.isRender=n.render??!0,i.inputOptions=n.inputOptions,i.label=n.label,i.fieldKey=n.key,n.tooltip&&(i.tooltip=n.tooltip)),r.push(i)}this.fieldElements=r}render(){!this._fields||this._fields.length===0||this.rendered||(this.dataset.groupId=this._name.toLowerCase(),this.clear(),this._name&&this._showName&&(this._nameContainerElement.append(s("h4",{textContent:this._name,className:y("body-small-bold"),style:{fontSize:".8rem",marginLeft:".25rem",lineHeight:"normal"}})),this.append(this._nameContainerElement)),this._fieldsContainerElement.append(...this.fieldElements),this.append(this._fieldsContainerElement),this.rendered=!0)}};customElements.define("setting-group",ie);var ae=class extends HTMLElement{constructor(){super();this._fieldKey="";this._isRender=!1,this.rendered=!1,this._label="Section",this._tooltipInstance=null,this.inputOptions=null,this._inputElement=new oe,this._labelContainer=s("div",{className:"label-wrapper",style:{display:"flex",gap:"0.5rem",alignItems:"center"}})}connectedCallback(){this.rendered||this.render(),this.updateVisibility()}disconnectedCallback(){this._tooltipInstance?.dispose()}set isRender(t){this._isRender=t,this.updateVisibility()}get isRender(){return this._isRender}updateVisibility(){this._isRender?(this.removeAttribute("hidden"),this.style.display="flex",this.style.visibility="visible"):(this.setAttribute("hidden","true"),this.style.display="none",this.style.visibility="hidden")}set tooltip(t){t&&(this._tooltipInstance||(this._tooltipInstance=new xe(t)),this._tooltipInstance.content=t)}clear(){this.innerHTML=""}render(){!this.inputOptions||this.rendered||(this.dataset.fieldId=this._label.toLowerCase(),this._labelContainer.append(s("p",{textContent:this._label,className:y("body-small")})),this._tooltipInstance&&this._labelContainer.append(this._tooltipInstance.elem),this._inputElement.inputOptions=this.inputOptions,this.append(this._labelContainer,this._inputElement),this.rendered=!0)}set label(t){this._label=t,this.rendered&&this.render()}get label(){return this._label}set fieldKey(t){this._fieldKey=t}get fieldKey(){return this._fieldKey}};customElements.define("setting-field",ae);var ze=e=>{let o="Invalid URL";try{let t=new URL(e);return["http:","https:"].includes(t.protocol)?{isValid:!0}:{isValid:!1,message:o}}catch{return{isValid:!1,message:o}}},se=(e,o,t)=>{let r=`Enter a number between ${o} and ${t}.`;return typeof e!="number"||Number.isNaN(e)?{isValid:!1,message:r}:e<o||e>t?{isValid:!1,message:r}:{isValid:!0}},P=e=>se(e,0,512),x=e=>se(e,0,256),w=e=>se(e,0,200),G=e=>se(e,0,100),zt=e=>se(e,0,10),Wt=e=>{if(!e||e.trim()==="")return{isValid:!1,message:"URL cannot be empty."};try{let o=new URL(e);return!o.hostname.endsWith("fonts.googleapis.com")&&!o.hostname.endsWith("fonts.gstatic.com")?{isValid:!1,message:"Hostname is not a Google Fonts domain."}:o.protocol!=="http:"&&o.protocol!=="https:"?{isValid:!1,message:"Protocol must be HTTP or HTTPS."}:!o.pathname.startsWith("/css")&&!o.pathname.startsWith("/earlyaccess")&&!o.hostname.endsWith("fonts.gstatic.com")?{isValid:!1,message:"Path is not a typical Google Fonts CSS path."}:o.hostname.endsWith("fonts.googleapis.com")&&!o.searchParams.has("family")?{isValid:!1,message:"URL does not contain the 'family' parameter."}:{isValid:!0}}catch{return{isValid:!1,message:"Invalid URL format."}}};async function Kt(e,o="Text copied to clipboard!"){if(navigator.clipboard)try{await navigator.clipboard.writeText(e),console.debug(o),d(o,!1,5e3)}catch(t){console.error("Error copying to clipboard:",t),d(`Error copying to clipboard: ${t instanceof Error?t.message:t}`,!0,5e3)}else console.error("Error copying text (navigator.clipboard not found)"),d("Error copying text (navigator.clipboard not found)",!0,5e3)}var T=null,qt=()=>new Promise((e,o)=>{if(T){console.debug("Lucid: Database already initialized."),e();return}let t=window.indexedDB.open("LucidImageDB",1);t.onerror=r=>{console.error("Database error:",r),o(r)},t.onsuccess=()=>{T=t.result,console.debug("Lucid: Database initialized."),e()},t.onupgradeneeded=()=>{T=t.result,console.debug("Lucid: Upgrading database..."),T.objectStoreNames.contains("imageStore")||T.createObjectStore("imageStore",{keyPath:"id"}).createIndex("data","data",{unique:!1})}}),Yt=(e,o)=>new Promise((t,r)=>{let n=()=>{if(!T)return;let a=T.transaction(["imageStore"],"readwrite").objectStore("imageStore"),c={id:1,data:e},p=a.put(c);p.onsuccess=()=>{console.debug("Image added/updated successfully."),o?.(),t()},p.onerror=u=>{console.error("Error adding/updating image",u),r(u)}};T?n():qt().then(n).catch(r)}),Zt=()=>new Promise((e,o)=>{let t=()=>{if(!T)return;let i=T.transaction(["imageStore"],"readonly").objectStore("imageStore").get(1);i.onsuccess=()=>{let a=i.result;e(a?a.data:null)},i.onerror=a=>{console.error("Error retrieving image",a),o(a)}};T?t():qt().then(t).catch(o)});function le(e){let o="";return e?.blur!==void 0&&(o+=`blur(${e.blur}px) `),e?.brightness!==void 0&&(o+=`brightness(${e.brightness}%) `),e?.contrast!==void 0&&(o+=`contrast(${e.contrast}%) `),e?.grayscale!==void 0&&(o+=`grayscale(${e.grayscale}) `),e?.hueRotate!==void 0&&(o+=`hue-rotate(${e.hueRotate}) `),e?.invert!==void 0&&(o+=`invert(${e.invert}) `),e?.opacity!==void 0&&(o+=`opacity(${e.opacity}%) `),e?.saturate!==void 0&&(o+=`saturate(${e.saturate||0}%) `),e?.sepia!==void 0&&(o+=`sepia(${e.sepia}) `),o.trim()}var ce=document.querySelector("lucid-bg-wrapper"),f=ce?.querySelector("lucid-bg"),C=null,z=null,k=null,mr=()=>{C=null,k=null,f||pe(),!z&&f&&(z=s("div",{className:"solid-bg",style:{backgroundColor:"var(--solid-bg-color, var(--clr-surface))",height:"100%",width:"100%"}}),f.innerHTML="",f.appendChild(z))},gr=()=>{z=null,k=null,f||pe(),!C&&f&&(C=s("img",{className:"static-bg",style:{display:"block",height:"100%",width:"100%",objectFit:"cover",filter:"var(--static-bg-filter)"}}),f.innerHTML="",f.appendChild(C))},hr=()=>{if(C=null,z=null,f||pe(),!k&&f){k=s("div",{className:"animated-bg-wrapper",style:{position:"relative",height:"100%",width:"100%"}}),f.innerHTML=`
<style>
.img{ position: absolute; border-radius: 20em; width: 200%; animation: animBg var(--anim-bg-time,60s) linear infinite;}
.img-0 { right: 30%; top: 0; z-index: 2 }
.img-1 { animation-direction: reverse; bottom: 0; left: 0; z-index: 1}
.img-2 { animation-direction: reverse; right: -50%; top: -20%; width: 300%; z-index: 0 }
@keyframes animBg { 0% { transform: rotate(0deg) translate3d(0px,0px,0px); } to { transform: rotate(1turn) translate3d(0px,0px,0px); } }
</style>
`;for(let e=0;e<3;e++){let o=s("img",{className:`img img-${e}`,style:{willChange:"transform",backgroundImage:"url(var(--image-url))"}});k.appendChild(o)}f.appendChild(k)}},Xt=(e=l.getState())=>{let o=e.background;switch(o.mode){case"solid":{z||mr();let{hex:t,alpha:r}=o.options.solid.color;z?.style.setProperty("--solid-bg-color",`${t}${I(r)}`);break}case"static":{if(C||gr(),!C)return;let{filter:t,isCustomImage:r}=o.options.static;r?C.setAttribute("custom-image",""):C.removeAttribute("custom-image"),C.style.setProperty("--static-bg-filter",le(t)),W();break}case"animated":{if(k||hr(),!k)return;let{filter:t,time:r}=o.options.animated;k.style.filter=le(t),k.style.setProperty("--anim-bg-time",`${r}s`),W();break}default:{console.error("Unexpected background mode:",o.mode),d("Unexpected error setting background.");break}}},br=e=>{if(f&&e){let o=new Image;o.src=e,o.onload=()=>{if(f||pe(),C&&(C.src=e??""),k){let t=k.querySelectorAll("img");for(let r of t)r.src=e??""}}}},pe=()=>{ce||(ce=s("div",{className:"lucid-bg-wrapper",style:{display:"block",position:"fixed",height:"100vh",width:"100vw",zIndex:"-1",top:"0",left:"0",overflow:"hidden"}}),(document.getElementById("main")??document.body).prepend(ce)),f||(f=s("div",{className:"lucid-bg",style:{display:"block",height:"100%",width:"100%",overflow:"hidden"}}),ce.prepend(f))},W=async()=>{let e=l.getState();if(e.background.mode==="solid")return;let o="";e.background.options.static.isCustomImage?e.customImage.type==="local"?o=await Zt():o=e.customImage.options.url.data:o=A.getState().url,br(o??"")};function Jt(){pe(),Xt(),W(),l.subscribe(e=>{Xt(e)},"background"),l.subscribe(()=>{W()},"customImage.type"),A.subscribe(()=>{W()})}var fr="guided-tour-styles",yr=`
body, #main { overflow: hidden; } 
.hidden, .tour-container.arrow-hidden:before { display: none; }
.tour-container {position: absolute;background-color: var(--clr-surface-2);padding: 1rem;border-radius: .5rem;max-width: 30em;box-shadow: 0 0 2rem rgba(0, 0, 0, 0.5);z-index: 99999;opacity: 0;visibility: hidden;transform: translate3d(0, -10px, 0);transition: opacity 0.3s ease-in-out, visibility 0.3s ease-in-out, transform 0.3s ease-in-out;}
.tour-container.full-width { width: 100%; max-width: 100% }
.tour-container.visible:before {content: "";position: absolute;height: 1.5rem;width: 1.5rem;border-radius: 6px;top: 0;left: 50%;background-color: var(--clr-surface-2);clip-path: polygon(0 0, 0% 100%, 100% 0);transform: rotate(45deg) translate(-50%, 0);z-index: -1;}
.tour-container.visible { opacity: 1; visibility: visible; transform: translate3d(0, 0, 0) }
.tour-btn {border: var(--border-thickness, 1px) var(--border-style, solid) var(--border-color, rgba(var(--clr-surface-5-rgb), 0.25));background-color: var(--clr-tertiary);color: var(--clr-on-tertiary);padding: .5rem 1rem;border-radius: .3rem;font-weight: 500;cursor: pointer;transition: background-color 225ms ease-in-out;}
.tour-btn:hover { background-color: var(--clr-on-tertiary); color: var(--clr-tertiary) }
.tour-btn.skip-btn { background-color: var(--clr-secondary); color: var(--clr-on-secondary) }
.tour-btn.skip-btn:hover { background-color: var(--clr-on-secondary); color: var(--clr-secondary) }
.tour-btn.prev-btn { background-color: var(--clr-primary); color: var(--clr-on-primary) }
.tour-btn.prev-btn:hover { background-color: var(--clr-on-primary); color: var(--clr-primary) }
.tour-button-wrapper { display: flex; justify-content: space-between; margin-top: 1rem; gap: .5rem; }
.tour-step-counter { margin-bottom: 0.5rem; text-align: center; font-weight: bold; color: var(--clr-on-surface); }
.tour-navigation-wrapper { display: flex; gap: 0.5rem; }
.tour-navigation-wrapper .next-btn { margin-left: 0.5rem; }
`,de=class extends HTMLElement{constructor(){super();this.steps=[];this.currentStepIndex=0;this.interactiveElements=[];g(fr).textContent=yr}connectedCallback(){this.style.position="fixed",this.style.inset="0px",this.style.pointerEvents="none"}set tourSteps(t){this.steps=t}get tourSteps(){return this.steps}start(){this.steps.length>0&&this.steps[0].onStart&&this.steps[0].onStart(),this.currentStepIndex=0,this.renderTooltip(),this.showStep()}renderTooltip(){if(!this.tooltip){this.tooltip=s("div",{className:"tour-container",role:"dialog",ariaModal:"true"}),this.stepCounter=s("div",{className:"tour-step-counter"}),this.message=s("div",{className:`tour-message ${y("body-medium")}`}),this.skipButton=this.createButton("skip-btn","Skip Tour",this.endTour.bind(this)),this.prevButton=this.createButton("prev-btn hidden","Previous",this.prevStep.bind(this)),this.nextButton=this.createButton("next-btn","Next",this.nextStep.bind(this));let t=s("div",{className:"tour-button-wrapper"}),r=s("div",{className:"tour-navigation-wrapper"});r.append(this.prevButton,this.nextButton),t.append(r),t.prepend(this.skipButton),this.tooltip.append(this.stepCounter,this.message,t),this.appendChild(this.tooltip)}}createButton(t,r,n){let i=s("button",{className:`tour-btn ${t}`,textContent:r});return i.onclick=n,i}async showStep(t=!1){if(this.currentStepIndex>=this.steps.length){this.endTour();return}let r=this.steps[this.currentStepIndex];if(this.targetElement=document.querySelector(r.target),!this.targetElement||this.targetElement.offsetParent===null){console.warn(`Skipping invisible or missing target: ${r.target}`),t?this.currentStepIndex--:this.currentStepIndex++,this.showStep(t);return}if(!this.targetElement){console.warn(`Target element not found: ${r.target}. Skipping step.`),t?this.currentStepIndex--:this.currentStepIndex++,this.showStep(t);return}this.targetElement.scrollIntoView({behavior:"smooth",block:"center"}),await new Promise(n=>setTimeout(n,r.wait??500)),this.disablePointerEvents(),this.enablePointerEventsForInteractiveElements(r),this.updateTooltip(r)}updateTooltip(t){if(!this.tooltip||!this.targetElement)return;this.tooltip.classList.toggle("arrow-hidden",!(t.arrow??!0)),this.stepCounter.textContent=`Step ${this.currentStepIndex+1} of ${this.steps.length}`,this.message.textContent=t.content,this.prevButton.classList.toggle("hidden",this.currentStepIndex===0),this.nextButton.textContent=this.currentStepIndex===this.steps.length-1?"End Tour":"Next";let r=this.targetElement.getBoundingClientRect(),n=this.tooltip.getBoundingClientRect(),i=0,a=0;switch(t.position||"center"){case"top right":i=r.top-n.height-16,a=r.right-n.width-32;break;case"top left":i=r.top-n.height-16,a=r.left-32;break;case"bottom left":i=r.bottom+16,a=r.left-32;break;case"bottom right":i=r.bottom+16,a=r.right-n.width-32;break;default:i=r.top+r.height+16,a=r.left+r.width/2-n.width/2,i+n.height>window.innerHeight&&(i=r.top-n.height-16);break}a<0?a=10:a+n.width>window.innerWidth&&(a=window.innerWidth-n.width-10),i<0?i=10:i+n.height>window.innerHeight&&(i=window.innerHeight-n.height-10),this.tooltip.style.transform=`translate3d(${a}px, ${i}px, 0)`,this.tooltip.classList.add("visible")}nextStep(){this.steps[this.currentStepIndex].onComplete&&this.steps[this.currentStepIndex].onComplete?.(),this.currentStepIndex++,this.showStep()}prevStep(){this.currentStepIndex>0?(this.steps[this.currentStepIndex-1]?.onPrevious&&this.steps[this.currentStepIndex-1].onPrevious?.(),this.currentStepIndex--,this.showStep(!0)):console.warn("Already at the first step, cannot go back.")}disablePointerEvents(){document.body.style.pointerEvents="none"}enablePointerEventsForInteractiveElements(t){if(!(!this.tooltip||!this.targetElement)){if(this.interactiveElements=[this.targetElement,this.tooltip],t.interactiveElementsSelector){let r=document.querySelectorAll(t.interactiveElementsSelector);for(let n of r)this.interactiveElements.push(n)}for(let r of this.interactiveElements)r.style.pointerEvents="auto"}}resetPointerEvents(){document.body.style.pointerEvents="auto";for(let t of this.interactiveElements)t.style.pointerEvents="auto";this.interactiveElements=[]}endTour(){console.debug("Tour skipped or ended."),this.resetPointerEvents(),this.tooltip&&(this.tooltip.classList.remove("visible"),this.tooltip.addEventListener("transitionend",()=>{this.tooltip&&(this.tooltip.parentElement?.removeChild(this.tooltip),this.tooltip=void 0)},{once:!0}))}};customElements.define("guided-tour",de);var We=(e,o)=>s("button",{className:`lucid-button ${y("body-small-bold")} ${e}`,textContent:o}).outerHTML;var Te=()=>{window?.lucid?.settings?.openSettings?.()},h={navBtn:"Click here to open settings.",ctxMenu:"Settings open button is in this context menu. Click to open it.",ctxMenuItem:"Click here to open settings.",welcomeModal:"Welcome to Lucid Settings! Here you can customize every aspect of your theme.",genTab:`Let's start in the "General" tab to customize basic settings.`,floatWin:`First, let's look at "Floating Window" setting. Control if the settings window floats or stays embedded.`,winPos:'Next, "Window Position". Choose where you want the settings to open - Navigation bar or Context menu.',intfTab:'Now, we are moving to the "Interface" tab to customize page and sidebar styles.',bgStyle:'In "Interface", find "Background Style". Here you can change the overall style of pages background.',npViewGrp:`Still in "Interface", let's customize "Now Playing View" sidebar.`,npViewMode:'Within "Now Playing View" settings, you can switch between "Normal" and "Compact" view modes for the sidebar.',bgTab:'Next, we will check "Background" tab to explore the theme background options.',bgMode:"Here you can change the background mode. Try switching between Animated, Solid Color, and Static Image to see different background types.",dynColor:"Checkout new Dynamic Color. This feature automatically adapts your theme\u2019s colors to match the album art of the song that's playing. Try switching songs to see the effect in action!",gFontsGrp:'In "Interface" tab, Here you can enable "Google Fonts" to unlock a vast library of fonts for your theme.',borderGrp:'Still in "Interface" tab, here, you can change the look and style of the application border.',playbarTab:`Let's move to the "Playbar Settings" tab to customize the playbar at the bottom.`,playbarType:'Try changing the "Playbar Type" between "Default" and "Compact" to see how it changes the layout.',advTab:'Finally, explore "Advanced Settings" tab for more control over the theme behavior.',closeModal:"That's all for the essential settings tour! Explore other options to fully customize Lucid. Click here to close settings."};function Qt(e=l.getState()){function o(){Y(),window?.lucid?.settings?.settingModal?.addEventListener("close",Te,{once:!0})}return[...e.position==="nav"?[{target:"button[aria-label='Lucid Settings']",content:h.navBtn,onComplete:o,interactiveElementsSelector:"button[aria-label='Lucid Settings']"}]:[{target:".main-userWidget-box",content:h.ctxMenu,onComplete:()=>{document.querySelector(".main-userWidget-box")?.click()},interactiveElementsSelector:".main-userWidget-box"},{target:".main-userWidget-dropDownMenu .main-contextMenu-menuItem:nth-child(3)",content:h.ctxMenuItem,wait:500,onComplete:o,interactiveElementsSelector:".main-userWidget-dropDownMenu .main-contextMenu-menuItem:nth-child(3)"}],{target:"lucid-settings-modal .modal-header-container",content:h.welcomeModal,arrow:!1,interactiveElementsSelector:".modal-header-container"},{target:'setting-section[data-tab-id="general"] .header-wrapper',content:h.genTab,arrow:!0,wait:700,interactiveElementsSelector:'setting-section[data-tab-id="general"] .header-wrapper'},{target:'setting-field[data-field-id="floating window"] .label-wrapper',content:h.floatWin,arrow:!0,interactiveElementsSelector:'setting-field[data-field-id="floating window"]',onStart:()=>{E.setState(n=>({...n,isFloating:!0}))}},{target:'setting-field[data-field-id="window position"] .label-wrapper',content:h.winPos,arrow:!0,interactiveElementsSelector:'setting-field[data-field-id="window position"]'},{target:'setting-section[data-tab-id="interface"] .header-wrapper',content:h.intfTab,arrow:!0,interactiveElementsSelector:'setting-section[data-tab-id="interface"] .header-wrapper',onStart:()=>{document.querySelector('setting-section[data-tab-id="interface"] .header-wrapper')?.scrollIntoView({behavior:"smooth",block:"center"})},wait:500},{target:'setting-section[data-tab-id="interface"] setting-field[data-field-id="background style"] .label-wrapper',content:h.bgStyle,arrow:!0,interactiveElementsSelector:'setting-section[data-tab-id="interface"] setting-field[data-field-id="background style"]',onStart:()=>{document.querySelector('setting-section[data-tab-id="interface"] setting-field[data-field-id="background style"] .label-wrapper')?.scrollIntoView({behavior:"smooth",block:"center"})},wait:500},{target:'setting-section[data-tab-id="interface"] setting-group[data-group-id="now playing view"] .header-wrapper',content:h.npViewGrp,arrow:!0,interactiveElementsSelector:'setting-section[data-tab-id="interface"] setting-group[data-group-id="now playing view"] .header-wrapper',onStart:()=>{document.querySelector('setting-section[data-tab-id="interface"] setting-group[data-group-id="now playing view"] .header-wrapper')?.scrollIntoView({behavior:"smooth",block:"center"})},wait:500},{target:'setting-section[data-tab-id="interface"] setting-group[data-group-id="now playing view"] setting-field[data-field-id="view mode"] .label-wrapper',content:h.npViewMode,arrow:!0,interactiveElementsSelector:'setting-section[data-tab-id="interface"] setting-group[data-group-id="now playing view"] setting-field[data-field-id="view mode"]',onStart:()=>{document.querySelector('setting-section[data-tab-id="interface"] setting-group[data-group-id="now playing view"] setting-field[data-field-id="view mode"] .label-wrapper')?.scrollIntoView({behavior:"smooth",block:"center"})},wait:500},{target:'setting-section[data-tab-id="background"] .header-wrapper',content:h.bgTab,arrow:!0,wait:700,interactiveElementsSelector:'setting-section[data-tab-id="background"] .header-wrapper'},{target:'setting-section[data-tab-id="background"] setting-field[data-field-id="background mode"]',content:h.bgMode,arrow:!0,wait:700,position:"bottom left",interactiveElementsSelector:'setting-section[data-tab-id="background"] setting-field[data-field-id="background mode"]'},{target:'setting-section[data-tab-id="background"] setting-field[data-field-id="dynamic color"]',content:h.dynColor,arrow:!0,wait:700,interactiveElementsSelector:'setting-section[data-tab-id="background"] setting-field[data-field-id="dynamic color"]'},{target:'setting-section[data-tab-id="interface"] setting-group[data-group-id="font"]',content:h.gFontsGrp,arrow:!0,wait:700,interactiveElementsSelector:'setting-section[data-tab-id="interface"] setting-field[data-field-id="google fonts"]',onStart:()=>{document.querySelector('setting-section[data-tab-id="interface"] setting-group[data-group-id="font"]')?.scrollIntoView({behavior:"smooth",block:"center"})}},{target:'setting-section[data-tab-id="interface"] setting-group[data-group-id="border"]',content:h.borderGrp,arrow:!0,wait:700,interactiveElementsSelector:'setting-section[data-tab-id="interface"] setting-field[data-field-id="style"]',onStart:()=>{document.querySelector('setting-group[data-group-id="border"]')?.scrollIntoView({behavior:"smooth",block:"center"})}},{target:'setting-section[data-tab-id="playbar settings"] .header-wrapper',content:h.playbarTab,arrow:!0,wait:700,interactiveElementsSelector:'setting-section[data-tab-id="playbar settings"] .header-wrapper',onStart:()=>{document.querySelector('setting-section[data-tab-id="playbar settings"] .header-wrapper')?.scrollIntoView({behavior:"smooth",block:"center"})}},{target:'setting-section[data-tab-id="playbar settings"] setting-field[data-field-id="playbar type"]',content:h.playbarType,arrow:!0,wait:700,interactiveElementsSelector:'setting-section[data-tab-id="playbar settings"] setting-field[data-field-id="playbar type"]',onStart:()=>{document.querySelector('setting-field[data-field-id="playbar type"]')?.scrollIntoView({behavior:"smooth",block:"center"})}},{target:'setting-section[data-tab-id="advanced settings"] .header-wrapper',content:h.advTab,arrow:!0,interactiveElementsSelector:'setting-section[data-tab-id="advanced settings"] .header-wrapper',onStart:()=>{document.querySelector('setting-section[data-tab-id="advanced settings"] .header-wrapper')?.scrollIntoView({behavior:"smooth",block:"center"})},wait:500},{target:"lucid-settings-modal custom-button.close",content:h.closeModal,arrow:!0,onComplete:()=>{window?.lucid?.settings?.settingModal?.removeEventListener("close",Te),window.dispatchEvent(new CustomEvent("remove-tour"))},interactiveElementsSelector:"lucid-settings-modal"}]}var R=null,V=null,vr=()=>{V&&(localStorage.setItem(H,"true"),V.start(),jt(),document.body.appendChild(V))},Sr=()=>{V&&(localStorage.setItem(H,"true"),V.endTour(),jt(),window?.lucid?.settings?.settingModal?.removeEventListener("close",Te))},wr=()=>{let e=s("div",{className:"tour-container arrow-hidden visible full-width",style:{position:"relative"},innerHTML:`<div class="tour-arrow"></div><div class="tour-message ${y("body-medium")}">Ready to explore lucid theme with a quick guided tour?</div><div class="tour-button-wrapper">${We("skip-btn tour-btn","Skip Tour")}${We("start-tour-btn tour-btn","Start Tour")}</div>`}),o=e.querySelector(".start-tour-btn"),t=e.querySelector(".skip-btn");return o.addEventListener("click",vr),t.addEventListener("click",Sr),e},Cr=()=>{R=new M,R.setHeader("Welcome to Lucid Theme!"),R.setContent(wr())},kr=()=>{R&&((document.getElementById("main")??document.body)?.appendChild(R),R.open())},jt=()=>{R&&(R.close(),R=null)},eo=()=>{try{localStorage.removeItem(H),Ke()}catch(e){console.error("Error opening guide",e),d("Error opening guide")}},Ke=()=>{try{if(localStorage.getItem(H)==="true")return;localStorage.setItem(H,"true"),V=new de;let e=o=>{V&&(V.tourSteps=Qt(o))};e(),l.subscribe(e,"position"),Cr(),kr()}catch(e){console.error("Error in tour: ",e)}};var ro=null,no=null,D=new q,Y=()=>{ro?.()},qe=()=>{no?.()},Er=()=>{let e=s("div",{id:"settings-container"}),o=new re;return o.isRender=!0,o.options=oo(),l.subscribe(t=>{o.options=oo(t)}),e.appendChild(o),e};function io(){D.isFloating=E.getState().isFloating,D.setContent(Er()),E.subscribe(e=>{D.isFloating=e.isFloating},"isFloating"),document.getElementById("main")?.append(D),ro=()=>D.open(),no=()=>D.close(),Ge(l.getState().position,Y),l.subscribe(e=>{Ge(e.position,Y)},"position")}var to={floatWin:["Floating Window","Allows settings to float. Drag header to reposition."],winPos:["Window Position","Settings window opens from context menu or nav bar."],bgMode:["Mode","Select background type."],isCusTopbarColor:["Set Custom Color","Set custom color for topbar background color."],backgroundColor:["Background Color","Pick solid background color."],custImg:["Custom Image","Use custom image URL for static background."],custUMVImg:["Custom Image","Use custom image URL for playlist background."],imgSrc:["Image Source","Upload image or use URL for custom background."],custImgUrl:["Custom Image URL","Enter image URL for static background."],custImgInput:["Select Custom Image","Select local image for static background."],custImgLocal:["Select Local Image","Select images for static background."],filterBlur:["Blur","Blur level of image (0-200)."],animatedTime:["Time","Time of animated background (1-512)."],animFilterBlur:["Blur","Blur level of animated background (0-200)."],filterBlurCustom:["Blur (Custom)","Blur level for custom page background (0-200)."],filterBlurNormal:["Blur (Default)","Blur level for default page background (0-200)."],filterBlurNpv:["Blur (NPV)","Blur level for NPV page background (0-200)."],filterExtendedBlur:["Extended background Blur","Blur level of extended page background (0-200)."],animFilterBright:["Brightness","Brightness of animated background (0-200)."],animFilterSat:["Saturation","Saturation of animated background (0-200)."],filterBright:["Brightness","Brightness of image (0-200)."],filterSat:["Saturation","Saturation of image (0-200)."],dynColor:["Dynamic Color","Dynamic color themes based on artwork."],tonalColor:["Tonal Color","Tonal color scheme for UI."],custColorEnable:["Custom Color","Enable custom color to override theme color."],custColorPicker:["Select Custom Color",'Choose base theme color. Preview: <a href="https://material-foundation.github.io/material-theme-builder/">Material Theme Builder</a>'],gFontsEnable:["Google Fonts","Enable fonts from Google Fonts."],gFontsUrl:["Google Fonts URL","URL of Google Fonts stylesheet."],fontFamily:["Font Family","Font family for UI when Google Fonts disabled."],grainType:["Grain Type","Type of grain effect overlay."],winCtrlHeight:["Control Height","Height of window control buttons on Windows (0-200)."],winPanelGap:["Panel Gap","Gap between main sections."],homeCardGap:["Home Card Gap","Gap between cards in main view."],newHomeStyle:["New Home Style","Add new styles for home."],flexyHomeStyle:["Flexy cards","Responsive and flexible card layout. Cards adapt to different screen sizes and arrange themselves for optimal viewing on any device."],borderThick:["Thickness","Thickness of interface border (0-10)."],borderColor:["Color","Color of application border."],borderStyle:["Style","Visual style of interface border."],pagesBgStyle:["Style","Background display on pages."],pagesImageStyle:["Image Style","Image on pages. (playlist/album art)"],homeHeaderBg:["Home Header Background","Enable/Disable Home header background."],scrollUmvBg:["Scroll Background","Scroll background main view background."],scaleUmvBg:["Scale Background","Scale background main view background."],rsbViewMode:["View Mode","Normal or compact 'Now Playing' sidebar."],rsbSize:["Compact Sidebar Width","Width of compact 'Now Playing' sidebar (0-512px)."],rsbPos:["Position","Position of compact 'Now Playing' sidebar."],rsbBgBlur:["Blur","Background blur of compact 'Now Playing' view (0-256)."],rsbCustBgEnable:["Custom Background","Enable custom background for Now Playing view."],rsbBgColor:["Color","Background color for 'Now Playing' sidebar."],rsbBgAlpha:["Alpha","Background transparency (alpha) value (0-100)."],rsbBorderAlpha:["Border Alpha","Border transparency (alpha) value (0-100)."],playbarType:["Playbar Type","Default or Compact playbar style."],compactPbHideIcons:["Hide Extra Playbar Icons","Hides extra icons in compact playbar (on hover)."],compactPbBorderRad:["Border Radius","Border Radius of compact playbar in pixels."],normalPbBorderRad:["Border Radius","Border Radius of normal playbar in pixels."],compactPbImgBorderRad:["Art Border Radius","Border Radius of the cover image in compact playbar in pixels."],normalPbImgBorderRad:["Art Border Radius","Border Radius of the cover image in normal playbar in pixels."],compactPbHeight:["Height","Height of compact playbar in pixels."],normalPbHeight:["Height","Height of normal playbar in pixels."],playbarFloat:["Floating","Now playing bar is floating."],pbBackdropBlur:["Backdrop Blur","Blur of normal playbar backdrop (0-256)."],pbBackdropSat:["Backdrop Saturation","Saturation of normal playbar backdrop (0-256)."],pbBackdropBright:["Backdrop Brightness","Brightness of normal playbar backdrop (0-256)."],topBarBackdropBlur:["Backdrop Blur","Blur of normal playbar backdrop (0-256)."],topBarBackdropSat:["Backdrop Saturation","Saturation of normal playbar backdrop (0-256)."],topBarBackdropBright:["Backdrop Brightness","Brightness of normal playbar backdrop (0-256)."],showChangelog:["Show Changelog","Changelog modal after updates."],lucidTour:["Take a Lucid Tour","Guided walkthrough of Lucid theme features."],exportSettings:["Export Settings","Export settings to clipboard as JSON."],importSettings:["Import Settings","Import settings from JSON."],resetSettings:["Reset All Settings","Reset all settings to default values (irreversible)."],pagesScrollType:["Image Source","Now Playing View art or default playlist art for pages."]};function oo(e=l.getState(),o=l){let t=(r,n,i)=>({render:i===void 0?!0:i,inputOptions:n,label:to[r][0],tooltip:to[r][1],key:r.replace(/([A-Z])/g,"-$1").toLowerCase()});return[{name:"General",render:!0,groups:[{render:!0,name:"Behavior",key:"group-behavior",showName:!1,fields:[t("lucidTour",{type:"button",buttonType:"primary",contents:"Start",onClick:()=>{localStorage.removeItem("lucid-guided-tour"),qe(),eo()}}),t("floatWin",{type:"checkbox",checked:E.getState().isFloating,onChange:r=>{E.setState(n=>({...n,isFloating:r}))}}),t("winPos",{type:"select",value:e.position,options:[{label:"Context Menu",value:"context-menu"},{label:"Navigation Bar",value:"nav"}],onChange:r=>{o.setPosition(r)}})]}]},{name:"Background",render:!0,groups:[{render:!0,name:"Mode",key:"group-background-mode",fields:[t("bgMode",{type:"select",value:e.background.mode,options:[{label:"Animated",value:"animated"},{label:"Solid Color",value:"solid"},{label:"Static Image",value:"static"}],onChange:r=>{o.setBackgroundMode(r)}})]},{name:"Background",key:"group-bg-background",render:!0,fields:[t("backgroundColor",{type:"color",value:e.background.options.solid.color.hex,onChange:r=>{o.setSolidBackgroundColor({hex:r})}},e.background.mode==="solid"),t("rsbBgAlpha",{type:"number",value:e.background.options.solid.color.alpha,validator:G,onChange:r=>{o.setSolidBackgroundColor({alpha:r})}},e.background.mode==="solid"),t("custImg",{type:"checkbox",checked:e.background.options.static.isCustomImage,onChange:r=>{o.setStaticBackgroundOptions({isCustomImage:r})}},e.background.mode!=="solid"),t("imgSrc",{type:"select",value:e.customImage.type,options:[{label:"Local",value:"local"},{label:"From Url",value:"url"}],onChange:r=>{o.setCustomImageType(r)}},e.background.mode!=="solid"&&e.background.options.static.isCustomImage),t("custImgUrl",{type:"text",value:e.customImage.options.url.data??"Enter Image URL",validator:ze,onChange:r=>{o.setCustomImageOptions("url",{data:r})}},e.background.mode!=="solid"&&e.background.options.static.isCustomImage&&e.customImage.type==="url"),t("custImgInput",{type:"image",onChange:r=>{r&&Yt(r,W)}},e.background.mode!=="solid"&&e.background.options.static.isCustomImage&&e.customImage.type==="local"),t("animatedTime",{type:"number",step:1,value:e.background.options.animated.time,validator:P,onChange:r=>{o.setAnimatedBackgroundOptions({time:r})}},e.background.mode==="animated")]},{render:e.background.mode!=="solid",name:"Filters",key:"group-bg-filters",fields:[t("filterBlur",{type:"number",value:e.background.options.static.filter.blur,onChange:r=>{o.setStaticBackgroundFilter({blur:r})},step:1,validator:w},e.background.mode==="static"),t("filterBright",{type:"number",value:e.background.options.static.filter.brightness,onChange:r=>{o.setStaticBackgroundFilter({brightness:r})},step:1,validator:w},e.background.mode==="static"),t("filterSat",{type:"number",value:e.background.options.static.filter.saturate,onChange:r=>{o.setStaticBackgroundFilter({saturate:r})},step:.1,validator:w},e.background.mode==="static"),t("animFilterBlur",{type:"number",value:e.background.options.animated.filter.blur,onChange:r=>{o.setAnimatedBackgroundFilter({blur:r})},step:1,validator:w},e.background.mode==="animated"),t("animFilterBright",{type:"number",value:e.background.options.animated.filter.brightness,onChange:r=>{o.setAnimatedBackgroundFilter({brightness:r})},step:1,validator:w},e.background.mode==="animated"),t("animFilterSat",{type:"number",value:e.background.options.animated.filter.saturate,onChange:r=>{o.setAnimatedBackgroundFilter({saturate:r})},step:1,validator:w},e.background.mode==="animated")]},{render:!0,name:"Color",key:"group-color",fields:[t("dynColor",{type:"checkbox",checked:e.color.isDynamic,onChange:r=>{o.setDynamicColor(r)}}),t("tonalColor",{type:"checkbox",checked:e.color.isTonal,onChange:r=>{o.setTonalColor(r)}}),t("custColorEnable",{type:"checkbox",checked:e.color.isCustom,onChange:r=>{o.setIsCustomColor(r)}},!e.color.isDynamic),t("custColorPicker",{type:"color",value:e.color.customColor.hex,onChange:r=>{o.setCustomColor({hex:r})}},!e.color.isDynamic&&e.color.isCustom)]}]},{name:"Interface",render:!0,groups:[{render:!0,name:"Font",key:"group-font",fields:[t("gFontsEnable",{type:"checkbox",checked:e.font.isGoogleFonts,onChange:r=>{o.setFont({isGoogleFonts:r})}}),t("gFontsUrl",{type:"text",value:e.font.fontUrl||"",validator:Wt,onChange:r=>{o.setFont({fontUrl:r})}},e.font.isGoogleFonts),t("fontFamily",{type:"text",value:e.font.fontFamily||"",onChange:r=>{o.setFont({fontFamily:r})}},!e.font.isGoogleFonts)]},{render:!0,key:"group-grain-effect",name:"Grain Effect",fields:[t("grainType",{type:"select",value:e.grains.type,options:[{label:"Normal",value:"default"},{label:"Starry",value:"starry"},{label:"None",value:"none"}],onChange:r=>{o.setGrainsType(r)}})]},{render:!0,key:"group-home-controls",name:"Home",fields:[t("newHomeStyle",{type:"checkbox",checked:e.pages.isNewHome,onChange:r=>{o.setPages({isNewHome:r})}}),t("flexyHomeStyle",{type:"checkbox",checked:e.pages.isFlexyHome,onChange:r=>{o.setPages({isFlexyHome:r})}},e.pages.isNewHome),t("homeCardGap",{type:"number",step:1,value:e.pages.homeCardGap,validator:G,onChange:r=>{o.setPages({homeCardGap:r})}})]},{render:!0,key:"group-window-controls",name:"Window",fields:[t("winPanelGap",{type:"number",step:1,value:e.pages.panelGap,validator:G,onChange:r=>{o.setPages({panelGap:r})}}),t("winCtrlHeight",{type:"number",step:1,value:e.control.height,validator:w,onChange:r=>{o.setControlHeight(r)}},ke())]},{render:!0,key:"group-border",name:"Border",fields:[t("borderThick",{type:"number",step:1,value:e.border.thickness,validator:zt,onChange:r=>{o.setBorder({thickness:r})}}),t("borderStyle",{type:"select",options:[{label:"None",value:"none"},{label:"Solid",value:"solid"},{label:"Dotted",value:"dotted"},{label:"Dashed",value:"dashed"},{label:"Double",value:"double"},{label:"Groove",value:"groove"},{label:"Ridge",value:"ridge"},{label:"Inset",value:"inset"},{label:"Outset",value:"outset"}],onChange:r=>{o.setBorder({style:r})},value:e.border.style}),t("borderColor",{type:"color",value:e.border.color.hex,onChange:r=>{o.setBorderColor({hex:r})}}),t("rsbBorderAlpha",{type:"number",value:e.border.color.alpha,validator:G,onChange:r=>{o.setBorderColor({alpha:r})}})]},{render:!0,key:"group-now-playing-view",name:"Now Playing View",fields:[t("rsbViewMode",{type:"select",value:e.rightSidebar.mode,options:[{label:"Normal",value:"normal"},{label:"Compact",value:"compact"}],onChange:r=>{o.setRightSidebar({mode:r})}}),t("rsbSize",{type:"number",value:e.rightSidebar.size,validator:P,onChange:r=>{o.setRightSidebar({size:r})}},e.rightSidebar.mode==="compact"),t("rsbPos",{type:"select",value:e.rightSidebar.position,options:[{label:"Top Left",value:"top left"},{label:"Top Right",value:"top right"},{label:"Bottom Left",value:"bottom left"},{label:"Bottom Right",value:"bottom right"}],onChange:r=>{o.setRightSidebar({position:r})}},e.rightSidebar.mode==="compact"),t("rsbBgBlur",{type:"number",value:e.rightSidebar.blur,validator:x,onChange:r=>{o.setRightSidebar({blur:r})}},e.rightSidebar.mode==="compact"),t("rsbCustBgEnable",{type:"checkbox",checked:e.rightSidebar.isCustomBg,onChange:r=>{o.setRightSidebar({isCustomBg:r})}}),t("rsbBgColor",{type:"color",value:e.rightSidebar.color.hex,onChange:r=>{o.setRightSidebarColor({hex:r})}},e.rightSidebar.isCustomBg),t("rsbBgAlpha",{type:"number",value:e.rightSidebar.color.alpha,validator:G,onChange:r=>{o.setRightSidebarColor({alpha:r})}},e.rightSidebar.isCustomBg)]}]},{name:"Page Settings",render:!0,groups:[{render:!0,key:"group-page-style",name:"Page Styles",fields:[t("homeHeaderBg",{type:"checkbox",checked:e.pages.hideHomeHeader,onChange:r=>{o.setPages({hideHomeHeader:r})}}),t("pagesBgStyle",{type:"select",value:e.pages.style,onChange:r=>{o.setPageStyle(r)},options:[{label:"Default",value:"normal"},{label:"Card",value:"card"},{label:"Compact",value:"compact"},{label:"Compact Card",value:"compact-card"}]}),t("pagesImageStyle",{type:"select",value:e.pages.imageStyle,onChange:r=>{o.setPageImageStyle(r)},options:[{label:"Default",value:"default"},{label:"As Bg",value:"as-bg"},{label:"Hidden",value:"hidden"}]}),t("pagesScrollType",{type:"select",value:e.pages.umv.type,options:[{value:"normal",label:"Default"},{value:"custom",label:"Custom"},{value:"npv",label:"Now Playing Art"}],onChange:r=>{o.setUMV({type:r})}}),t("custUMVImg",{type:"text",validator:ze,value:e.pages.umv.options.custom.url??"Enter a Url",onChange:r=>{o.setUMVOption("custom",{url:r})}},e.pages.umv.type==="custom")]},{key:"group-page-image-filter",name:"Page Background Image Filter",render:!0,fields:[t("filterBlurCustom",{type:"number",validator:w,value:e.pages.umv.options.custom.filter?.blur,onChange:r=>{o.setUMVFilter("custom",{blur:r})}},e.pages.umv.type==="custom"),t("filterBlurNormal",{type:"number",validator:w,value:e.pages.umv.options.normal.filter?.blur,onChange:r=>{o.setUMVFilter("normal",{blur:r})}},e.pages.umv.type==="normal"),t("filterBlurNpv",{type:"number",validator:w,value:e.pages.umv.options.npv.filter?.blur,onChange:r=>{o.setUMVFilter("npv",{blur:r})}},e.pages.umv.type==="npv"),t("filterExtendedBlur",{type:"number",validator:w,value:e.pages.umv.options.expanded.filter?.blur,onChange:r=>{o.setUMVFilter("expanded",{blur:r})}})]},{key:"group-page-bg-behavior",name:"Background Behavior",render:!0,fields:[t("scrollUmvBg",{type:"checkbox",checked:e.pages.umv.isScroll,onChange:r=>{o.setUMV({isScroll:r})}}),t("scaleUmvBg",{type:"checkbox",checked:e.pages.umv.isScaling,onChange:r=>{o.setUMV({isScaling:r})}})]}]},{name:"Topbar Settings",render:!0,groups:[{render:!0,showName:!0,name:"Background",key:"topbar-setting-background",fields:[t("isCusTopbarColor",{type:"checkbox",checked:e.topbar.isCustomColor,onChange:r=>{o.setIsCustomTopbarColor(r)}}),t("backgroundColor",{type:"color",value:e.topbar.bgColor.hex,onChange:r=>{o.setTopbarColor({hex:r})}},e.topbar.isCustomColor),t("rsbBgAlpha",{type:"number",value:e.topbar.bgColor.alpha,validator:G,onChange:r=>{o.setTopbarColor({alpha:r})}},e.topbar.isCustomColor)]},{render:!0,showName:!0,name:"Backdrop Filters",key:"topbar-setting-filters",fields:[t("topBarBackdropBlur",{type:"number",value:e.topbar.backdropFilter.blur,validator:x,onChange:r=>{o.setTopbarFilter({blur:r})}},e.playbar.isFloating),t("topBarBackdropSat",{type:"number",value:e.topbar.backdropFilter.saturate,validator:x,onChange:r=>{o.setTopbarFilter({saturate:r})}},e.playbar.isFloating),t("topBarBackdropBright",{type:"number",value:e.topbar.backdropFilter.brightness,validator:x,onChange:r=>{o.setTopbarFilter({brightness:r})}},e.playbar.isFloating)]}]},{name:"Playbar Settings",render:!0,groups:[{render:!0,name:"General",key:"group-playbar-general",showName:!1,fields:[t("playbarType",{type:"select",value:e.playbar.type,onChange:r=>{o.setPlaybar({type:r})},options:[{label:"Default",value:"normal"},{label:"Compact",value:"compact"}]}),t("playbarFloat",{type:"checkbox",checked:e.playbar.isFloating,onChange:r=>{o.setPlaybar({isFloating:r})}})]},{render:e.playbar.type==="compact",name:"Compact Playbar",key:"group-playbar-compact",showName:!0,fields:[t("compactPbHideIcons",{type:"checkbox",checked:e.playbar.hideIcons,onChange:r=>{o.setPlaybar({hideIcons:r})}}),t("compactPbHeight",{type:"number",value:e.playbar.options.compact.height,validator:P,onChange:r=>{o.setPlaybarOptions("compact",{height:r})}}),t("compactPbBorderRad",{type:"number",value:e.playbar.options.compact.borderRadius,validator:P,onChange:r=>{o.setPlaybarOptions("compact",{borderRadius:r})}}),t("pbBackdropBlur",{type:"number",value:e.playbar.options.compact.backdropFilter.blur,validator:x,onChange:r=>{o.setPlaybarFilter("compact",{blur:r})}},e.playbar.isFloating),t("pbBackdropSat",{type:"number",value:e.playbar.options.compact.backdropFilter.saturate,validator:x,onChange:r=>{o.setPlaybarFilter("compact",{saturate:r})}},e.playbar.isFloating),t("pbBackdropBright",{type:"number",value:e.playbar.options.compact.backdropFilter.brightness,validator:x,onChange:r=>{o.setPlaybarFilter("compact",{brightness:r})}},e.playbar.isFloating),t("compactPbImgBorderRad",{type:"number",value:e.playbar.options.compact.imageRadius,validator:P,onChange:r=>{o.setPlaybarOptions("compact",{imageRadius:r})}})]},{render:e.playbar.type==="normal",name:"Normal Playbar",key:"group-playbar-normal",showName:!0,fields:[t("normalPbHeight",{type:"number",value:e.playbar.options.normal.height,validator:P,onChange:r=>{o.setPlaybarOptions("normal",{height:r})}}),t("normalPbBorderRad",{type:"number",value:e.playbar.options.normal.borderRadius,validator:P,onChange:r=>{o.setPlaybarOptions("normal",{borderRadius:r})}}),t("pbBackdropBlur",{type:"number",value:e.playbar.options.normal.backdropFilter.blur,validator:x,onChange:r=>{o.setPlaybarFilter("normal",{blur:r})}},e.playbar.isFloating),t("pbBackdropSat",{type:"number",value:e.playbar.options.normal.backdropFilter.saturate,validator:x,onChange:r=>{o.setPlaybarFilter("normal",{saturate:r})}},e.playbar.isFloating),t("pbBackdropBright",{type:"number",value:e.playbar.options.normal.backdropFilter.brightness,validator:x,onChange:r=>{o.setPlaybarFilter("normal",{brightness:r})}},e.playbar.isFloating),t("normalPbImgBorderRad",{type:"number",value:e.playbar.options.normal.imageRadius,validator:P,onChange:r=>{o.setPlaybarOptions("normal",{imageRadius:r})}})]}]},{name:"Advanced Settings",render:!0,groups:[{render:!0,name:"App Settings",key:"group-application-settings",showName:!1,fields:[t("showChangelog",{type:"checkbox",checked:e.showChangelog,onChange:r=>{o.setChangelog(r)}}),t("exportSettings",{type:"button",buttonType:"primary",contents:"Copy Settings",onClick:()=>{Kt(o.exportSettings(),"Settings copied to clipboard!")}}),t("importSettings",{type:"text",value:"",validator:r=>{try{return ve(JSON.parse(r))?{isValid:!0}:{isValid:!1,message:"Not a valid lucid settings."}}catch{return{isValid:!1,message:"Not a valid lucid settings."}}},onChange:r=>{o.importSettings(r)}}),t("resetSettings",{type:"button",buttonType:"danger",contents:"Reset",onClick:()=>{confirm("Are you sure you want to reset all settings to default values? This action cannot be undone.")&&(o.resetState(),window.location.reload())}})]}]}]}function ao(e=l.getState().rightSidebar){e.position?document.body.setAttribute("npv-position",e.position):document.body.removeAttribute("npv-position"),e.mode?document.body.setAttribute("npv-mode",e.mode):document.body.removeAttribute("npv-mode"),document.body.style.setProperty("--npv-blur",`${e.blur}px`),e.isCustomBg?document.body.style.setProperty("--npv-bg-color",`${e.color.hex}${I(e.color.alpha)}`):document.body.style.removeProperty("--npv-bg-color");function o(t){document.body.style.setProperty("--npv-size",`${t}px`)}o(e.size)}function so(){ao(),l.subscribe(e=>{ao(e.rightSidebar)},"rightSidebar")}var Ie=null;function lo(e=l.getState().grains){let o=e.type;Ie!==o&&(Ie&&document.body.classList.remove(`grain-${Ie}`),o?(document.body.setAttribute("grain-type",o),document.body.classList.add(`grain-${o}`)):document.body.removeAttribute("grain-type"),Ie=o)}function co(){lo(),l.subscribe(e=>{lo(e.grains)},"grains")}function _r(e,o){let t=e.split(".").map(Number),r=o.split(".").map(Number),n=Math.max(t.length,r.length);for(let i=0;i<n;i++){let a=t[i]||0,c=r[i]||0;if(a>c)return 1;if(a<c)return-1}return 0}var ue=class extends HTMLElement{constructor(t){super();this._data=null;this.hasUpdate=!1;this._currentVersion=Q,t&&(this._data=t,this.hasUpdate=this.checkForUpdate())}connectedCallback(){g("lucid-changelog").textContent=".changelog-entry,.update-available-header {  padding: 1rem 1rem;  background-color: rgba(var(--clr-on-secondary-rgb), 0.5);  color: var(--clr-secondary);  margin-bottom: 0.5rem;  border-radius: 0.5rem;}.update-available-header {  text-align: center;  font-size: 1.8em;  color: var(--clr-primary);}.changelog-entry > p {  margin-bottom: 0.5rem;}.changes-wrapper {  display: flex;  flex-wrap: wrap;  gap: 0.5rem;}.changelog-entry,.update-available-header,.change-card {  border: var(--border-thickness, 1px) var(--border-style, solid)    var(--border-color, var(--clr-surface-5, #1c1b1e));}.change-card {  flex-grow: 1;  padding: 10px;  border-radius: 0.75rem;  min-width: 10em;}.change-card:nth-child(2n) {  background-color: rgba(var(--clr-on-primary-rgb), 0.7);  color: var(--clr-primary);}.change-card:nth-child(2n + 1) {  background-color: rgba(var(--clr-on-secondary-rgb), 0.7);  color: var(--clr-secondary);}.change-card:nth-child(2n + 3) {  background-color: rgba(var(--clr-on-tertiary-rgb), 0.7);  color: var(--clr-tertiary);}.change-card li {  list-style: disc;  margin-left: 2rem;}.change-card li:marker {  right: 4px;}",this.render()}checkForUpdate(){if(this._data&&this._data.length>0&&this._currentVersion){let t=this._data[0].version;return _r(t,this._currentVersion)>0}return!1}render(){if(this.innerHTML="",!this._data){this.innerHTML="<p>Error loading changelog data.</p>",console.error("Invalid changelog data format.");return}if(this._data.length<1){this.innerHTML="<p>No changelog entries available.</p>",console.warn("No elements present to show changelog.");return}let t=this._data.map(i=>{let a="";for(let p in i.changes)if(Object.prototype.hasOwnProperty.call(i.changes,p)){let u=i.changes[p];if(u&&u.length>0){let bo=u.map(fo=>`<li>${fo}</li>`).join("");a+=`
                    <div class="change-card">
                      <h3 class='encore-text encore-text-small-bold'>${p}</h3>
                      <ul>${bo}</ul>
                    </div>
                  `}}let c=i.desc?`<p>${i.desc}</p>`:"";return`
              <div class="changelog-entry">
                <h2>${i.version} - ${i.date}</h2>
                ${c}
                <div class="changes-wrapper">
                  ${a}
                </div>
              </div>
            `}).join(""),r="";this.hasUpdate&&(r='<h1 class="update-available-header">Update Available</h1>');let n=document.createElement("div");n.innerHTML=`
        ${r}
        <div class="changelog-entries-container">${t}</div>`,this.appendChild(n)}updateData(t){this._data=t,this.hasUpdate=this.checkForUpdate(),this.render()}};customElements.define("changelog-component",ue);async function xr(){try{let e=await Ce(ot,he,21600);return JSON.parse(e)}catch(e){return console.error("Error fetching changelog.",e),[]}}async function po(e=document.body){if(!l.getState().showChangelog)return;let o=await xr();if(typeof o=="object"&&o.length<1){console.error("Changelog data not found.");return}let t=new M;t.setHeader("Lucid Changelog");let r=new ue(o);!(localStorage.getItem(U)===Q)||r.hasUpdate?(t.setContent(r),e.appendChild(t),t.open(),localStorage.setItem(U,Q)):console.debug("Changelog already shown for this version.")}var uo=()=>{window.lucid={config:()=>l.getState(),reset:()=>{l.resetState()},store:l,version:localStorage.getItem(U)??"2.1.3",settings:{openSettings:Y,closeSettings:qe,settingModal:D}}};function Ye(e=l.getState()){let o=e.border,t=g("lucid-border");t.textContent=":root{",t.textContent+=`--border-color:${o.color.hex}${I(o.color.alpha)};`,o.style&&(t.textContent+=`--border-style:${o.style};`),o.thickness&&(t.textContent+=`--border-thickness:${o.thickness}px;`),t.textContent+="}"}l.subscribe(Ye,"border");function mo(e){let o=e.match(/url\(["']?(.*?)["']?\)/);return o?o[1]:null}var Ze="lucid-umv-wrapper",Xe="umv",Z="umv-img",Tr="lucid-umv",Ir="lucid-scroll",Le=s("div",{className:Ze}),v=s("div",{className:Xe}),me=s("div",{className:Z});function Lr(){L([nt],([e])=>{if(!e){d("Lucid: No scroll element found.",!0);return}if(typeof v>"u"||!v){d("Lucid: imgWrapperElem is not defined.",!0);return}let o=g(Ir);if(!o){d("Lucid: Failed to load scroll indicator style.",!0);return}o.textContent=`
@property --scroll-top {
  syntax: '<length>';
  inherits: false;
  initial-value: 0;
}
@property --scroll-coefficient {
  syntax: '<number>';
  inherits: false;
  initial-value: 0;
}`;let t=!0;e.addEventListener("scrollend",()=>{t=!0}),e.addEventListener("scroll",()=>{if(t){let r=document.querySelectorAll(".Root__main-view .marketplace-header,.mjZrvVI3CxfHJXu7y0Lg,.fIvMht6B9HdROywMNJZ4, .main-home-filterChipsSection, .Root__main-view .main-home-filterChipsSection, .Root__main-view .main-trackList-trackListHeaderStuck.main-trackList-trackListHeader, .Root__main-view .main-topBar-background, .Root__main-view .search-searchCategory-SearchCategory");for(let n of r)n.style.willChange="transform",n.offsetHeight;t=!1}}),e.addEventListener("scroll",r=>{let n=r.target;if(!(n instanceof HTMLElement))return;let i=n.scrollTop;i>window.innerHeight||(v.style.setProperty("--scroll-top",`-${Math.round(i)}px`),v.style.setProperty("--scroll-coefficient",`${Math.min(1,Math.max(0,i/window.innerHeight))}`))})})}function Br(){g(Tr).innerHTML=`
.under-main-view { display: none; }
.main-entityHeader-container.main-entityHeader-withBackgroundImage{height: calc(100cqh - var(--umv-offset) - 1rem);}
body[data-path="/"] .lucid-umv-wrapper {display: none}
.main-entityHeader-container{ height: 40cqh; }
.main-entityHeader-backgroundColor,.main-actionBarBackground-background { background: none !important;}
.playlist-playlist-playlistContent,.EmeHQXR87mUskYK6xEde { background-color: rgba(var(--clr-surface-1-rgb),.5) !important; }
.${Ze} .${Xe} {height: 50cqh;width: 100%;position: absolute;z-index: -1;inset: 0}
.${Ze} .${Xe}.expanded,
body[npb-is-floating] .main-entityHeader-container.main-entityHeader-withBackgroundImage{height: calc(100cqh - var(--umv-offset))}
.${Z} {height: 100%;width: 100%;object-fit: contain;border: none;box-shadow: none;background-image: none;transition: background-image .3s ease-in-out;background-position: center center;background-repeat: no-repeat;background-size: cover;-webkit-mask-image: linear-gradient(rgb(0, 0, 0) 35cqh, rgba(0, 0, 0, 0) 100%);mask-image: linear-gradient(rgb(0, 0, 0) 35cqh, rgba(0, 0, 0, 0) 100%)}
.normal .${Z}{background-image: var(--page-img-url);filter: var(--normal-filter)}
.npv .${Z}{background-image: var(--npv-img-url);filter: var(--npv-filter)}
.custom .${Z}{background-image: var(--custom-img-url);filter: var(--custom-filter)}
.expanded .${Z}{background-image: var(--umv-img-url);filter: var(--expanded-filter);-webkit-mask-image: none;mask-image: none}
`}function Mr(e=l.getState().pages.umv){v.style.transform=`translate3d(0px,${e.isScroll?"var(--scroll-top)":"0px"},0px) scale(${e.isScaling?"calc(1 + var(--scroll-coefficient))":"1"})`,v.style.filter="blur(calc(16px * var(--scroll-coefficient)))";for(let o in e.options){let t=e.options[o];Le.style.setProperty(`--${o}-filter`,le(t.filter??{})),o==="custom"&&me.style.setProperty("--custom-img-url",`url(${t?.url??""})`),v.classList.toggle("custom",e.type==="custom"),v.classList.toggle("npv",e.type==="npv")}}function Pr(){let e=(o=l.getState())=>{Mr(o.pages.umv)};l.subscribe(e,"pages.umv"),e()}function Rr(){let e=async(o=Spicetify?.Platform?.History?.location)=>{if(o?.pathname){let t=await vt(o.pathname);v.classList.toggle("normal",!!t),me.style.setProperty("--page-img-url",`url("${t}")`)}};e(),Spicetify.Platform?.History?.listen(async o=>{await e(o)})}function Hr(){let e=document.querySelector(Be);if(!e){console.warn(`Element "${Be}" not found. UMV visibility observation will not work.`);return}let o=()=>{let r=e.querySelector(it);if(v.classList.remove("expanded"),r){let n=mo(r.style.backgroundImage);n&&(v.classList.add("expanded"),me.style.setProperty("--umv-img-url",`url(${n})`))}else me.style.removeProperty("--umv-img-url")};new MutationObserver(o).observe(e,{childList:!0,subtree:!0})}function Or(){let e=document.querySelector(".under-main-view")?.parentElement;e?e.prepend(Le):document.querySelector(".main-view-container")?.prepend(Le)}function go(){Lr(),Br(),Or(),v.appendChild(me),Le.appendChild(v),Pr(),Rr(),Hr()}function Je(e=l.getState().topbar){let o=g("lucid-topbar");o.textContent=`
:root,
.marketplace-header,
.main-home-filterChipsSection,
.main-trackList-trackListHeaderStuck.main-trackList-trackListHeader,
.main-topBar-background,
.search-searchCategory-SearchCategory{
    --top-bar-blur: ${e.backdropFilter.blur??32}px;
    --top-bar-saturate: ${e.backdropFilter.saturate??150}%;
    --top-bar-brightness: ${e.backdropFilter.brightness??80}%;
    ${e.isCustomColor?`--top-bar-color: ${e.bgColor.hex?e.bgColor.hex+I(e.bgColor.alpha):`rgba(var(--clr-surface-1-rgb), ${e.bgColor.alpha}%)`}`:""} }`}l.subscribe(e=>{Je(e.topbar)},"topbar");function ho(){L([".Root"],([e])=>{if(!e)return;new MutationObserver(()=>{let t=e.querySelector(".FP_XXx0FMQPJEu3WzfpM");if(!t)return;new MutationObserver(()=>{let n=/rgb\(\s*((?:\d{1,3}\s*,\s*){2}\d{1,3})\s*\)/,i=t.style.backgroundColor.match(n)?.[1];!i||!t.parentElement||t.parentElement.style.setProperty("--accent-color",i)}).observe(t,{attributes:!0})}).observe(e,{childList:!0})})}var Ar=()=>{try{uo(),L([".Root__now-playing-bar",".Root__globalNav"],([o,t])=>{document.body.style.setProperty("--umv-offset",`${(o?.clientHeight||80)+(t?.clientHeight||64)}px`)}),go(),Jt(),Ye(),Je(),at(),ht(),co(),Fe(),Lt(),Pt(),Ht(),so(),$e(),l.subscribe(o=>{$e(o.color)},"color"),io(),po(),Ke(),ho();let e=document.querySelector(".global-nav, .Root__globalNav");document.body.classList.toggle("global-nav",!!e),document.body.classList.toggle("control-nav",!e)}catch(e){console.error("Unexpected Error: ",e),d("Lucid: Unexpected error. please report it to dev")}};console.time("Main fn start");Ar();console.timeEnd("Main fn start");})();
})();